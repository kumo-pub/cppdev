<!doctype html>
<html lang="zh-cn" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-foundamentals/log/logging" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">日志 | Kumo Search</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/cppdev/zh-cn/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/cppdev/zh-cn/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/log/logging"><meta data-rh="true" property="og:locale" content="zh_cn"><meta data-rh="true" property="og:locale:alternate" content="en_GB"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="日志 | Kumo Search"><meta data-rh="true" name="description" content="turbo 日志库提供了将程序状态的简短文本消息写入 stderr、磁盘文件 或 其他接收器（通过扩展 API）的工具。"><meta data-rh="true" property="og:description" content="turbo 日志库提供了将程序状态的简短文本消息写入 stderr、磁盘文件 或 其他接收器（通过扩展 API）的工具。"><link data-rh="true" rel="icon" href="/cppdev/zh-cn/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/log/logging"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/cppdev/docs/foundamentals/log/logging" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/log/logging" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/cppdev/docs/foundamentals/log/logging" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"基础开发","item":"https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/category/foundamentals"},{"@type":"ListItem","position":2,"name":"日志","item":"https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/log/"},{"@type":"ListItem","position":3,"name":"教程","item":"https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/category/log-tutorial"},{"@type":"ListItem","position":4,"name":"日志","item":"https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/log/logging"}]}</script><link rel="alternate" type="application/rss+xml" href="/cppdev/zh-cn/blog/rss.xml" title="Kumo Search RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/cppdev/zh-cn/blog/atom.xml" title="Kumo Search Atom Feed"><link rel="stylesheet" href="/cppdev/zh-cn/assets/css/styles.582e0043.css">
<script src="/cppdev/zh-cn/assets/js/runtime~main.ab755061.js" defer="defer"></script>
<script src="/cppdev/zh-cn/assets/js/main.0dd454fe.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/cppdev/zh-cn/img/kumo-logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cppdev/zh-cn/"><div class="navbar__logo"><img src="/cppdev/zh-cn/img/kumo-logo.svg" alt="Kumo logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/cppdev/zh-cn/img/kumo-logo.svg" alt="Kumo logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">开发导论</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cppdev/zh-cn/docs/intro">教程</a><a class="navbar__item navbar__link" href="/cppdev/zh-cn/docs/integration/overview">集成</a><a class="navbar__item navbar__link" href="/cppdev/zh-cn/blog">博客</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/kumose" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文（中国）</a><ul class="dropdown__menu"><li><a href="/cppdev/docs/foundamentals/log/logging" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-GB">English</a></li><li><a href="/cppdev/zh-cn/docs/foundamentals/log/logging" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-cn">中文（中国）</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cppdev/zh-cn/docs/intro"><span title="概览" class="linkLabel_WmDU">概览</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/cppdev/zh-cn/docs/category/foundamentals"><span title="基础开发" class="categoryLinkLabel_W154">基础开发</span></a><button aria-label="折叠侧边栏分类 &#x27;基础开发&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/testing/"><span title="性能测试与单元测试" class="categoryLinkLabel_W154">性能测试与单元测试</span></a><button aria-label="展开侧边栏分类 &#x27;性能测试与单元测试&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/log/"><span title="日志" class="categoryLinkLabel_W154">日志</span></a><button aria-label="折叠侧边栏分类 &#x27;日志&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/category/get-start"><span title="快速开始" class="categoryLinkLabel_W154">快速开始</span></a><button aria-label="展开侧边栏分类 &#x27;快速开始&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cppdev/zh-cn/docs/category/log-tutorial"><span title="教程" class="categoryLinkLabel_W154">教程</span></a><button aria-label="折叠侧边栏分类 &#x27;教程&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/log/logging"><span title="日志" class="linkLabel_WmDU">日志</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/log/sinks"><span title="自定义日志接收器（Log Sinks）" class="linkLabel_WmDU">自定义日志接收器（Log Sinks）</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/log/builtin_sinks"><span title="内置 LogSink 接收器" class="linkLabel_WmDU">内置 LogSink 接收器</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/log/flags"><span title="配置日志" class="linkLabel_WmDU">配置日志</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/time"><span title="时间与日历" class="linkLabel_WmDU">时间与日历</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/category/standardized-errors-and-error-return-values"><span title="标准化错误与错误返回值" class="categoryLinkLabel_W154">标准化错误与错误返回值</span></a><button aria-label="展开侧边栏分类 &#x27;标准化错误与错误返回值&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/strings/"><span title="strings 操作" class="categoryLinkLabel_W154">strings 操作</span></a><button aria-label="展开侧边栏分类 &#x27;strings 操作&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/flags"><span title="Turbo 命令行标志（Turbo Flags）" class="linkLabel_WmDU">Turbo 命令行标志（Turbo Flags）</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/codec/"><span title="编码与解码" class="categoryLinkLabel_W154">编码与解码</span></a><button aria-label="展开侧边栏分类 &#x27;编码与解码&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/format/"><span title="格式化与输出（字符串格式化和输出）" class="linkLabel_WmDU">格式化与输出（字符串格式化和输出）</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/map/"><span title="map容器" class="categoryLinkLabel_W154">map容器</span></a><button aria-label="展开侧边栏分类 &#x27;map容器&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/compress/"><span title="压缩与解压缩" class="categoryLinkLabel_W154">压缩与解压缩</span></a><button aria-label="展开侧边栏分类 &#x27;压缩与解压缩&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/fibers/"><span title="Fiber And Future" class="categoryLinkLabel_W154">Fiber And Future</span></a><button aria-label="展开侧边栏分类 &#x27;Fiber And Future&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/monitor/"><span title="监控" class="categoryLinkLabel_W154">监控</span></a><button aria-label="展开侧边栏分类 &#x27;监控&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/filesystem/"><span title="文件系统" class="categoryLinkLabel_W154">文件系统</span></a><button aria-label="展开侧边栏分类 &#x27;文件系统&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/json/"><span title="json" class="categoryLinkLabel_W154">json</span></a><button aria-label="展开侧边栏分类 &#x27;json&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/rpc/"><span title="rpc远程调用" class="categoryLinkLabel_W154">rpc远程调用</span></a><button aria-label="展开侧边栏分类 &#x27;rpc远程调用&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/retrieve/"><span title="检索开发" class="categoryLinkLabel_W154">检索开发</span></a><button aria-label="展开侧边栏分类 &#x27;检索开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/store/"><span title="存储" class="categoryLinkLabel_W154">存储</span></a><button aria-label="展开侧边栏分类 &#x27;存储&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/ir/"><span title="IR" class="categoryLinkLabel_W154">IR</span></a><button aria-label="展开侧边栏分类 &#x27;IR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/advance/"><span title="进阶开发" class="categoryLinkLabel_W154">进阶开发</span></a><button aria-label="展开侧边栏分类 &#x27;进阶开发&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/cppdev/zh-cn/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cppdev/zh-cn/docs/category/foundamentals"><span>基础开发</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cppdev/zh-cn/docs/foundamentals/log/"><span>日志</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cppdev/zh-cn/docs/category/log-tutorial"><span>教程</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">日志</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>日志</h1></header>
<p>turbo 日志库提供了将程序状态的简短文本消息写入 <code>stderr</code>、<code>磁盘文件</code> 或 <code>其他接收器</code>（通过扩展 API）的工具。</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="API">API 概览<a href="#API" class="hash-link" aria-label="API 概览的直接链接" title="API 概览的直接链接" translate="no">​</a></h2>
<p><code>KLOG()</code> 和 <code>kCHECK()</code> 宏族是 API 的核心。每个宏都形成一条语句的起点，可以向其中流式传入额外数据，就像 <code>std::cout</code> 一样。</p>
<p>所有流入单个宏的数据都会被拼接，并作为一条消息写入日志文件，前面带有由元数据（时间、文件/行号等）形成的 <a href="#prefix" class="">前缀</a>。值得注意的是，与 <code>std::cout</code> 不同，本库会在每条消息末尾自动添加换行符，因此通常不应在日志语句末尾使用 <code>\n</code> 或 <code>std::endl</code>。任何显式流入的换行符仍会出现在日志文件中。</p>
<p>有关更详细的信息，请参考头文件。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="KLOG"><code>KLOG()</code> 宏<a href="#KLOG" class="hash-link" aria-label="KLOG的直接链接" title="KLOG的直接链接" translate="no">​</a></h3>
<p><code>KLOG()</code> 接受一个严重性级别作为参数，该参数定义要记录的日志信息的粒度和类型。四个基本严重性级别为 <code>INFO</code>、<code>WARNING</code>、<code>ERROR</code> 和 <code>FATAL</code>。<code>FATAL</code> 并非随意命名；它会在记录完流式消息后使日志库终止进程。
有关 <a href="#severity" class="">日志级别</a> 的更多信息，包括如何选择级别的最佳实践，请参见下文。</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">KLOG(INFO) &lt;&lt; &quot;Hello Kumo!&quot;;</span><br></span></code></pre></div></div>
<p>这将在日志中生成类似以下的消息：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">I0926 09:00:00.000000 12345 foo.cc:10] Hello Kumo!</span><br></span></code></pre></div></div>
<p>元数据的格式在 <a href="#prefix" class="">下文</a> 有说明。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="kCHECK"><code>kCHECK()</code> 宏<a href="#kCHECK" class="hash-link" aria-label="kCHECK的直接链接" title="kCHECK的直接链接" translate="no">​</a></h3>
<p><code>kCHECK()</code> 是一个断言。其严重性始终为 <code>FATAL</code>，所以其唯一参数是一个应为真的条件。如果条件不满足，<code>kCHECK()</code> 会写入日志并终止进程。它在 <strong>所有构建模式</strong> 下都是激活的（与 C 的 <code>assert()</code> 宏不同），并以类似 <code>KLOG()</code> 的方式将失败信息记录到应用日志，但会包含关于失败原因和发生位置的额外信息。</p>
<p>像 <code>FATAL</code> 一样，<code>CHECK()</code> 断言应谨慎使用（尤其是在服务端代码中），仅在确实需要终止进程而不是尝试恢复时使用，例如：不可恢复的错误，或者可能破坏用户数据的内存损坏。注意，你还应了解代码可能运行的位置；在命令行工具或批处理任务中使用 <code>kCHECK()</code> 风险较低，而在面向用户的服务中则需谨慎。如果不确定代码运行环境（例如，你在编写工具库），应假定它会在面向生产的服务中使用，并尽量避免使用 <code>kCHECK()</code>。</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kCHECK(!filenames_sorted.empty()) &lt;&lt; &quot;no files matched&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ProcessFile(filenames_sorted.front());</span><br></span></code></pre></div></div>
<p>这将在日志中生成类似以下的消息：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">F0926 09:00:01.000000   12345 foo.cc:100] Check failed: !filenames_sorted.empty() no files matched</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E0926 09:00:01.150000   12345 process_state.cc:1133] *** SIGABRT received by PID 12345 (TID 12345) on cpu 0 from PID 12345; stack trace: ***</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">E0926 09:00:01.250000   12345 process_state.cc:1136] PC: @     0xdeadbeef  (unknown)  raise</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @     0xdeadbeef       1920  FailureSignalHandler()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    @     0xdeadc0w5    2377680  (unknown)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(更多堆栈帧省略)</span><br></span></code></pre></div></div>
<p>注意，该日志条目使用 <code>F</code> 前缀表示 <code>FATAL</code> 级别。条件文本会在流式操作数之前记录。此外，堆栈跟踪以 <code>ERROR</code> 严重性（前缀为 <code>E</code>）记录，在 <code>FATAL</code> 消息之后、进程终止之前。</p>
<p>特殊的两参数形式包括 <code>CHECK_EQ()</code>、<code>CHECK_GT()</code>、<code>CHECK_STREQ()</code>（用于 <code>char*</code> 字符串）等，可用于断言可流式、可比较类型之间的比较。除了记录参数文本，还会记录参数的实际值。</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">int x = 3, y = 5;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">CHECK_EQ(2 * x, y) &lt;&lt; &quot;oops!&quot;;</span><br></span></code></pre></div></div>
<p>这将在日志中生成类似以下的消息：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">F0926 09:00:02.000000   12345 foo.cc:20] Check failed: 2 * x == y (6 vs. 5) oops!</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="severity">日志级别<a href="#severity" class="hash-link" aria-label="日志级别的直接链接" title="日志级别的直接链接" translate="no">​</a></h3>
<p><code>turbo::LogSeverity</code> 类型表示严重性级别。传给 <code>KLOG()</code> 的参数实际上不是该类型，也不是 <em>任何</em> 类型。通过宏技巧，使 <code>KLOG(ERROR)</code> 能在不使用宏或全局符号 <code>ERROR</code> 的情况下工作。这是必要的，因为 <code>ERROR</code> 被某些流行第三方包（如 Windows）定义，无法重新定义。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="四个正式日志级别">四个正式日志级别<a href="#四个正式日志级别" class="hash-link" aria-label="四个正式日志级别的直接链接" title="四个正式日志级别的直接链接" translate="no">​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="severity-info"><code>INFO</code><a href="#severity-info" class="hash-link" aria-label="severity-info的直接链接" title="severity-info的直接链接" translate="no">​</a></h5>
<p>对应 <code>turbo::LogSeverity::kInfo</code>。描述程序状态的重要、<em>预期</em> 事件，但不表示问题。库（尤其是底层公共库）应谨慎使用此级别，以避免污染所有使用它的程序日志。</p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="severity-warning"><code>WARNING</code><a href="#severity-warning" class="hash-link" aria-label="severity-warning的直接链接" title="severity-warning的直接链接" translate="no">​</a></h5>
<p>对应 <code>turbo::LogSeverity::kWarning</code>。描述<em>可能</em>表示问题但程序可恢复的非预期事件。</p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="severity-error"><code>ERROR</code><a href="#severity-error" class="hash-link" aria-label="severity-error的直接链接" title="severity-error的直接链接" translate="no">​</a></h5>
<p>对应 <code>turbo::LogSeverity::kError</code>。描述程序已从中恢复的非预期问题事件。<code>ERROR</code> 消息应可采取行动，即应描述软件或配置的实际问题（而非用户输入等），并且消息、文件名、行号及上下文应足以理解报告的事件。</p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="severity-fatal"><code>FATAL</code><a href="#severity-fatal" class="hash-link" aria-label="severity-fatal的直接链接" title="severity-fatal的直接链接" translate="no">​</a></h5>
<p>对应 <code>turbo::LogSeverity::kFatal</code>，也是 <code>kCHECK</code> 失败的隐式严重性。描述不可恢复的问题。该级别日志会终止进程。在服务（尤其是面向用户的服务）及可能被包含在此类服务中的库代码中，应谨慎使用。每条致命日志都有潜在宕机风险，若大量服务工作进程同时触发。
致命日志通常更适用于开发工具、批处理任务或作业启动失败。尽管如此，进程终止和宕机总比未定义行为（可能包括用户数据损坏或安全/隐私事件）更安全，因此在服务器和库代码中，对于无法通过其他方式处理的意外行为，<code>FATAL</code> 有时也是最后手段。</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="两个伪级别">两个伪级别<a href="#两个伪级别" class="hash-link" aria-label="两个伪级别的直接链接" title="两个伪级别的直接链接" translate="no">​</a></h4>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="severity-dfatal"><code>DFATAL</code><a href="#severity-dfatal" class="hash-link" aria-label="severity-dfatal的直接链接" title="severity-dfatal的直接链接" translate="no">​</a></h5>
<p>(&quot;debug fatal&quot;) 对应 <code>turbo::kLogDebugFatal</code>。在优化构建中，其值为 <code>ERROR</code>（如生产环境），在其他构建中为 <code>FATAL</code>（如测试）。可确保意外事件导致测试失败（通过终止进程），但不会影响生产环境。生产工作进程在 <code>DFATAL</code> 失败后继续运行，因此需保证恢复平滑。</p>
<h5 class="anchor anchorTargetStickyNavbar_Vzrq" id="severity-qfatal"><code>QFATAL</code><a href="#severity-qfatal" class="hash-link" aria-label="severity-qfatal的直接链接" title="severity-qfatal的直接链接" translate="no">​</a></h5>
<p>(&quot;quiet fatal&quot;) 没有对应的 <code>turbo::LogSeverity</code> 值。行为类似 <code>FATAL</code>，但不记录堆栈跟踪，也不运行 <code>atexit()</code> 处理器。通常适用于启动阶段错误（如 flag 校验），此时控制流无关紧要，诊断信息也不必要。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="动态日志级别">动态日志级别<a href="#动态日志级别" class="hash-link" aria-label="动态日志级别的直接链接" title="动态日志级别的直接链接" translate="no">​</a></h3>
<p>如果想通过 C++ 表达式指定严重性级别（例如在运行时动态选择级别），也可以：</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">KLOG(LEVEL(MoonPhase() == kFullMoon ? turbo::LogSeverity::kFatal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                   : turbo::LogSeverity::kError))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;&lt; &quot;Spooky error!&quot;;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="VKLOG"><code>VKLOG()</code> 宏<a href="#VKLOG" class="hash-link" aria-label="VKLOG的直接链接" title="VKLOG的直接链接" translate="no">​</a></h3>
<p><code>VKLOG()</code> (&quot;verbose log&quot;) 用于运行时可配置的调试日志。该宏接受一个非负整数作为参数——严重性隐式为 <code>INFO</code>。详细级别值是任意的，但数值越低，消息越显眼。非零详细级别默认禁用，禁用的 <code>VKLOG()</code> 性能开销很小，因此在 Kumo 的大部分地方可以放心大量使用 <code>VKLOG()</code>，不会显著影响性能。</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Foo::Foo(int num_bars) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  VKLOG(4) &lt;&lt; &quot;Constructing a new Foo with &quot; &lt;&lt; num_bars &lt;&lt; &quot; Bars&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for (int i = 0; i &lt; num_bars; i++) bars_.push_back(MakeBar(this));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<p>设置 <code>--verbosity</code> flag 可启用所有小于等于指定级别的 <code>VKLOG()</code> 消息，这可能会使日志难以阅读或占满磁盘。<code>--vmodule</code> flag 允许为不同源文件设置不同级别；参数为逗号分隔的 <code>key=value</code> 列表，其中 <code>key</code> 是匹配文件名的 glob，<code>value</code> 为对应的详细级别。也可以在运行时通过 <code>turbo::set_vlog_level</code> 和 <code>turbo::set_global_vlog_level</code> 修改详细级别：</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">class FooTest : public testing::Test {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> protected:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  FooTest() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 将 Foo 的 `VKLOG()` 级别调高，因为它默认日志较少：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    turbo::set_vlog_level(&quot;foo_impl&quot;, 4);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="mutators">其他宏变体<a href="#mutators" class="hash-link" aria-label="其他宏变体的直接链接" title="其他宏变体的直接链接" translate="no">​</a></h3>
<p>日志 API 包含许多用于特殊情况的附加宏。</p>
<ul>
<li class=""><code>QCHECK()</code> 类似 <code>kCHECK()</code>，与 <code>QFATAL</code> 的关系同 <code>kCHECK()</code> 与 <code>FATAL</code> 的关系：失败时不记录堆栈，也不运行 <code>atexit()</code> 处理器。</li>
</ul>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> int main (int argc, char**argv) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   turbo::ParseCommandLine(argc, argv);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   QCHECK(!turbo::get_flag(FLAGS_path).empty()) &lt;&lt; &quot;--path is required&quot;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ...</span><br></span></code></pre></div></div>
<ul>
<li class=""><code>PKLOG()</code> 和 <code>PKCHECK()</code> 会自动在日志消息末尾附加 <code>errno</code> 的文本描述及其数值，适用于系统库调用失败时指示失败原因。其名称与 <code>perror</code> 函数对应。</li>
</ul>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">   const int fd = open(path.c_str(), O_RDONLY);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   PKCHECK(fd != -1) &lt;&lt; &quot;Failed to open &quot; &lt;&lt; path;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   const ssize_t bytes_read = read(fd, buf, sizeof(buf));</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   PKCHECK(bytes_read != -1) &lt;&lt; &quot;Failed to read from &quot; &lt;&lt; path;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   const int close_ret = close(fd);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   if (close_ret == -1) PKLOG(WARNING) &lt;&lt; &quot;Failed to close &quot; &lt;&lt; path;</span><br></span></code></pre></div></div>
<ul>
<li class=""><code>DKLOG()</code> (&quot;debug log&quot;) 和 <code>DKCHECK()</code> 在优化构建中会完全消失。注意，<code>DKLOG(FATAL)</code> 和 <code>DKCHECK()</code> 的语义与 <code>KLOG(DFATAL)</code> 有很大不同。
调试日志适用于收集在测试中有用但生产中代价高的信息（如获取竞争锁）：</li>
</ul>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DKLOG(INFO) &lt;&lt; server.State();</span><br></span></code></pre></div></div>
<p>谨慎使用 <code>DKCHECK()</code>；如果在测试中值得检查，生产中可能也值得：</p>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">DKCHECK(ptr != nullptr);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ptr-&gt;Method();</span><br></span></code></pre></div></div>
<p><code>DKCHECK</code> 有时用于非常热点路径中的不变量检查，依赖测试中的检查来验证生产行为。
类似 <code>assert()</code>，确保不要依赖 <code>DKCHECK</code> 和 <code>DKLOG</code> 的副作用：</p>
<p>DKCHECK(server.Start());
// 优化构建中，server 根本不会被启动！</p>
<ul>
<li class=""><code>LOG_IF()</code> 增加条件参数，相当于 <code>if</code> 语句。类似 <code>if</code> 和三元运算符，条件会根据上下文转换为 <code>bool</code>。还存在 <code>PLOG_IF()</code> 和 <code>DLOG_IF()</code> 等变体。</li>
</ul>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">LOG_IF(INFO, turbo::get_flag(FLAGS_dry_run))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;&lt; &quot;--dry_run set; no changes will be made&quot;;</span><br></span></code></pre></div></div>
<ul>
<li class=""><code>LOG_EVERY_N()</code>、<code>LOG_FIRST_N()</code>、<code>LOG_EVERY_N_SEC()</code> 和 <code>LOG_EVERY_POW_2()</code> 提供更复杂的条件，简单 <code>if</code> 难以实现。每条语句在存储中维护一个静态状态对象，用于判断何时再次记录日志。它们是线程安全的。
token <code>COUNTER</code> 可以流式传入，会被替换为该语句执行的次数（包括已记录和未记录日志的次数）。还有带附加条件的宏变体（如 <code>LOG_IF_EVERY_N()</code>），以及与 <code>VKLOG()</code>、<code>PKLOG()</code>、<code>DLOG()</code> 的多种组合。</li>
</ul>
<div class="language-c++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-c++ codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">LOG_EVERY_N(WARNING, 1000) &lt;&lt; &quot;Got a packet with a bad CRC (&quot; &lt;&lt; COUNTER</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                          &lt;&lt; &quot; total)&quot;;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="修改器方法">修改器方法<a href="#修改器方法" class="hash-link" aria-label="修改器方法的直接链接" title="修改器方法的直接链接" translate="no">​</a></h3>
<p><code>KLOG()</code> 和 <code>kCHECK()</code> 宏支持多个可链式调用的方法来改变行为。</p>
<ul>
<li class="">
<p><code>.AtLocation(std::string_view file, int line)</code>
覆盖从调用点推断的位置。<code>file</code> 指向的字符串在语句结束前必须有效。</p>
</li>
<li class="">
<p><code>.NoPrefix()</code>
省略本条日志的 <a href="#prefix" class="">前缀</a>。前缀包含元数据，如源代码位置和时间戳。</p>
</li>
<li class="">
<p><code>.WithVerbosity(int verbose_level)</code>
设置日志消息的详细级别，类似由 <code>VLOG(verbose_level)</code> 生成。不同于 <code>VLOG()</code>，此方法不会影响语句在指定 <code>verbose_level</code> 禁用时是否被评估。仅影响使用 <code>turbo::LogSink::verbosity()</code> 的 <code>LogSink</code> 实现。可使用 <code>turbo::LogEntry::kNoVerbosityLevel</code> 表示该消息无详细级别。</p>
</li>
<li class="">
<p><code>.WithTimestamp(turbo::Time timestamp)</code>
使用指定时间戳，而不是执行时收集的时间戳。</p>
</li>
<li class="">
<p><code>.WithThreadID(turbo::LogEntry::tid_t tid)</code>
使用指定线程 ID，而不是执行时收集的线程 ID。</p>
</li>
<li class="">
<p><code>.WithMetadataFrom(const turbo::LogEntry &amp;entry)</code>
从指定 <code>turbo::LogEntry</code> 复制所有元数据（不包括数据）。
可用于修改消息的严重性，但有一些限制：</p>
</li>
<li class="">
<p><code>TURBO_MIN_LOG_LEVEL</code> 以传给 <code>KLOG</code> 的严重性（或 <code>CHECK</code> 的隐式 <code>FATAL</code>）为依据。</p>
</li>
<li class="">
<p><code>KLOG(FATAL)</code> 和 <code>kCHECK</code> 无条件终止进程，即使之后更改严重性也无效。</p>
</li>
<li class="">
<p><code>.WithPerror()</code>
在消息末尾附加冒号、空格、当前 <code>errno</code> 的文本描述（根据 <code>strerror(3)</code>）及其数值。效果等同于 <code>PKLOG()</code> 和 <code>PKCHECK()</code>。</p>
</li>
<li class="">
<p><code>.ToSinkAlso(turbo::LogSink* sink)</code>
将消息发送到 <code>*sink</code>，同时仍发送到其他原本会发送的 sink。<code>sink</code> 不能为空。</p>
</li>
<li class="">
<p><code>.ToSinkOnly(turbo::LogSink* sink)</code>
将消息仅发送到 <code>*sink</code>。<code>sink</code> 不能为空。</p>
</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="output">日志消息输出<a href="#output" class="hash-link" aria-label="日志消息输出的直接链接" title="日志消息输出的直接链接" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="prefix">日志前缀<a href="#prefix" class="hash-link" aria-label="日志前缀的直接链接" title="日志前缀的直接链接" translate="no">​</a></h3>
<p>每条消息都带有如下元数据：</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">I0926 09:00:00.000000   12345 foo.cc:10] Hello world!</span><br></span></code></pre></div></div>
<p>前缀以 <code>I</code> 开头，表示 <code>INFO</code> 级别，接着是日期 <code>0926</code>。时间为微秒，使用机器本地时区。<code>12345</code> 是线程 ID。<code>foo.cc:10</code> 是 <code>KLOG()</code> 语句在源代码中的位置，方括号和空格为固定分隔符。</p>
<p>可以通过 <code>FLAGS_log_with_prefix</code> 全局 flag 或单条消息的 <code>.NoPrefix()</code> <a href="#mutators" class="">修改器方法</a> 来抑制前缀。</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="stderr"><code>stderr</code> 输出<a href="#stderr" class="hash-link" aria-label="stderr的直接链接" title="stderr的直接链接" translate="no">​</a></h3>
<p>默认情况下，会注册一个写入 <code>stderr</code> 的 <code>LogSink</code>。</p></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/cppdev/zh-cn/docs/category/log-tutorial"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Log Tutorial</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cppdev/zh-cn/docs/foundamentals/log/sinks"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">自定义日志接收器（Log Sinks）</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#API" class="table-of-contents__link toc-highlight">API 概览</a><ul><li><a href="#KLOG" class="table-of-contents__link toc-highlight"><code>KLOG()</code> 宏</a></li><li><a href="#kCHECK" class="table-of-contents__link toc-highlight"><code>kCHECK()</code> 宏</a></li><li><a href="#severity" class="table-of-contents__link toc-highlight">日志级别</a></li><li><a href="#动态日志级别" class="table-of-contents__link toc-highlight">动态日志级别</a></li><li><a href="#VKLOG" class="table-of-contents__link toc-highlight"><code>VKLOG()</code> 宏</a></li><li><a href="#mutators" class="table-of-contents__link toc-highlight">其他宏变体</a></li><li><a href="#修改器方法" class="table-of-contents__link toc-highlight">修改器方法</a></li></ul></li><li><a href="#output" class="table-of-contents__link toc-highlight">日志消息输出</a><ul><li><a href="#prefix" class="table-of-contents__link toc-highlight">日志前缀</a></li><li><a href="#stderr" class="table-of-contents__link toc-highlight"><code>stderr</code> 输出</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cppdev/zh-cn/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/jefflothar" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cppdev/zh-cn/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kumo-pub" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2026 Kumo, Inc.</div></div></div></footer></div>
</body>
</html>