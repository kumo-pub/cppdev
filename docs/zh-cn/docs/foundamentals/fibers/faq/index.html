<!doctype html>
<html lang="zh-cn" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-foundamentals/fibers/faq" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">FAQ | Kumo Foundamental</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://your-docusaurus-site.example.com/cppdev/zh-cn/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://your-docusaurus-site.example.com/cppdev/zh-cn/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/fibers/faq"><meta data-rh="true" property="og:locale" content="zh_cn"><meta data-rh="true" property="og:locale:alternate" content="en_GB"><meta data-rh="true" name="docusaurus_locale" content="zh-cn"><meta data-rh="true" name="docsearch:language" content="zh-cn"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="FAQ | Kumo Foundamental"><meta data-rh="true" name="description" content="Q: Is kthread a coroutine?"><meta data-rh="true" property="og:description" content="Q: Is kthread a coroutine?"><link data-rh="true" rel="icon" href="/cppdev/zh-cn/img/favicon.svg"><link data-rh="true" rel="canonical" href="https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/fibers/faq"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/cppdev/docs/foundamentals/fibers/faq" hreflang="en-GB"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/fibers/faq" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://your-docusaurus-site.example.com/cppdev/docs/foundamentals/fibers/faq" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Foundamentals","item":"https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/category/foundamentals"},{"@type":"ListItem","position":2,"name":"Fiber And Future","item":"https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/fibers/"},{"@type":"ListItem","position":3,"name":"FAQ","item":"https://your-docusaurus-site.example.com/cppdev/zh-cn/docs/foundamentals/fibers/faq"}]}</script><link rel="alternate" type="application/rss+xml" href="/cppdev/zh-cn/blog/rss.xml" title="Kumo Foundamental RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/cppdev/zh-cn/blog/atom.xml" title="Kumo Foundamental Atom Feed"><link rel="stylesheet" href="/cppdev/zh-cn/assets/css/styles.a7490ef4.css">
<script src="/cppdev/zh-cn/assets/js/runtime~main.84ee4f51.js" defer="defer"></script>
<script src="/cppdev/zh-cn/assets/js/main.3113f152.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/cppdev/zh-cn/img/kumo-logo.svg"><div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切换导航栏" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/cppdev/zh-cn/"><div class="navbar__logo"><img src="/cppdev/zh-cn/img/kumo-logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/cppdev/zh-cn/img/kumo-logo.svg" alt="My Site Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">My Site</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/cppdev/zh-cn/docs/intro">教程</a><a class="navbar__item navbar__link" href="/cppdev/zh-cn/docs/integration/overview">Integration</a><a class="navbar__item navbar__link" href="/cppdev/zh-cn/blog">Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_nlXk"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>中文（中国）</a><ul class="dropdown__menu"><li><a href="/cppdev/docs/foundamentals/fibers/faq" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en-GB">English</a></li><li><a href="/cppdev/zh-cn/docs/foundamentals/fibers/faq" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-cn">中文（中国）</a></li></ul></div><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="切换浅色/暗黑模式（当前为system mode）"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/cppdev/zh-cn/docs/intro"><span title="介绍" class="linkLabel_WmDU">介绍</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/cppdev/zh-cn/docs/category/foundamentals"><span title="Foundamentals" class="categoryLinkLabel_W154">Foundamentals</span></a><button aria-label="折叠侧边栏分类 &#x27;Foundamentals&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/testing/"><span title="Performance Testing and Unit Testing" class="categoryLinkLabel_W154">Performance Testing and Unit Testing</span></a><button aria-label="展开侧边栏分类 &#x27;Performance Testing and Unit Testing&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/log/"><span title="Log Section" class="categoryLinkLabel_W154">Log Section</span></a><button aria-label="展开侧边栏分类 &#x27;Log Section&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/time"><span title="Time and Calendar" class="linkLabel_WmDU">Time and Calendar</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/category/standardized-errors-and-error-return-values"><span title="Standardized Errors and Error Return Values" class="categoryLinkLabel_W154">Standardized Errors and Error Return Values</span></a><button aria-label="展开侧边栏分类 &#x27;Standardized Errors and Error Return Values&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/strings/"><span title="strings operations" class="categoryLinkLabel_W154">strings operations</span></a><button aria-label="展开侧边栏分类 &#x27;strings operations&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/flags"><span title="Turbo Command-Line Flags (Turbo Flags)" class="linkLabel_WmDU">Turbo Command-Line Flags (Turbo Flags)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/codec/"><span title="Codec" class="categoryLinkLabel_W154">Codec</span></a><button aria-label="展开侧边栏分类 &#x27;Codec&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/format/"><span title="Format &amp; Output (String Formatting and Output)" class="linkLabel_WmDU">Format &amp; Output (String Formatting and Output)</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/map/"><span title="Map Containers" class="categoryLinkLabel_W154">Map Containers</span></a><button aria-label="展开侧边栏分类 &#x27;Map Containers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/compress/"><span title="Compression" class="categoryLinkLabel_W154">Compression</span></a><button aria-label="展开侧边栏分类 &#x27;Compression&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/fibers/"><span title="Fiber And Future" class="categoryLinkLabel_W154">Fiber And Future</span></a><button aria-label="折叠侧边栏分类 &#x27;Fiber And Future&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/fibers/futures"><span title="Futures" class="linkLabel_WmDU">Futures</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/fibers/std-future"><span title="std-future" class="linkLabel_WmDU">std-future</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/fibers/execution_queue"><span title="Execution Queue" class="linkLabel_WmDU">Execution Queue</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/fibers/kthread_schedule"><span title="kthread Scheduling and Execution Flow" class="linkLabel_WmDU">kthread Scheduling and Execution Flow</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/fibers/kthread_or_not"><span title="Thread Model Selection" class="linkLabel_WmDU">Thread Model Selection</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/fibers/faq"><span title="FAQ" class="linkLabel_WmDU">FAQ</span></a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/monitor/"><span title="monitor" class="categoryLinkLabel_W154">monitor</span></a><button aria-label="展开侧边栏分类 &#x27;monitor&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/filesystem/"><span title="filesystem" class="categoryLinkLabel_W154">filesystem</span></a><button aria-label="展开侧边栏分类 &#x27;filesystem&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/cppdev/zh-cn/docs/foundamentals/json/"><span title="json" class="categoryLinkLabel_W154">json</span></a><button aria-label="展开侧边栏分类 &#x27;json&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/rpc/"><span title="rpc" class="categoryLinkLabel_W154">rpc</span></a><button aria-label="展开侧边栏分类 &#x27;rpc&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/retrieve/"><span title="Retrieve" class="categoryLinkLabel_W154">Retrieve</span></a><button aria-label="展开侧边栏分类 &#x27;Retrieve&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/store/"><span title="store" class="categoryLinkLabel_W154">store</span></a><button aria-label="展开侧边栏分类 &#x27;store&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/ir/"><span title="IR" class="categoryLinkLabel_W154">IR</span></a><button aria-label="展开侧边栏分类 &#x27;IR&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/cppdev/zh-cn/docs/advance/"><span title="advance" class="categoryLinkLabel_W154">advance</span></a><button aria-label="展开侧边栏分类 &#x27;advance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/cppdev/zh-cn/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cppdev/zh-cn/docs/category/foundamentals"><span>Foundamentals</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/cppdev/zh-cn/docs/foundamentals/fibers/"><span>Fiber And Future</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">FAQ</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>FAQ</h1></header>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="q-is-kthread-a-coroutine">Q: Is kthread a coroutine?<a href="#q-is-kthread-a-coroutine" class="hash-link" aria-label="Q: Is kthread a coroutine?的直接链接" title="Q: Is kthread a coroutine?的直接链接" translate="no">​</a></h2>
<p>No. The coroutines we commonly refer to specifically mean <strong>N:1 threading libraries</strong>—all coroutines run within a single system thread, with computational capabilities equivalent to various event loop libraries. Since coroutine switching does not involve system calls (no cross-thread operations), it can be extremely fast (100ns-200ns) and less affected by cache coherence. However, this comes at the cost of inefficient multi-core utilization: code must be non-blocking, otherwise all coroutines will be stuck, imposing strict requirements on developers. This characteristic makes coroutines suitable for writing IO servers with deterministic execution time (e.g., HTTP servers), which can achieve extremely high throughput in carefully tuned scenarios.</p>
<p>However, most online services within Baidu have <strong>non-deterministic execution time</strong>, and many retrieval tasks are collaboratively developed by dozens of engineers. A single slow function can block all coroutines. Event loops share this limitation: if a callback blocks, the entire loop is stuck. For example, <strong>ub</strong>a<strong>server</strong> (note the letter &quot;a&quot;—not ubserver) was Baidu&#x27;s attempt at an asynchronous framework, composed of multiple parallel event loops. Its real-world performance was poor: slow logging operations, delays in Redis access, or heavy computation workloads in callbacks would cause a large number of pending requests to time out. As a result, this framework never gained popularity.</p>
<p>kthread is an <strong>M<!-- -->:N<!-- --> threading library</strong>—a blocked kthread does not affect other kthreads. It relies on two key technologies:</p>
<ol>
<li class=""><strong>Work stealing scheduling</strong>: Enables kthreads to be scheduled to more CPU cores faster.</li>
<li class=""><strong>Butex</strong>: A synchronization primitive that allows kthreads and pthreads to wait for and wake each other.</li>
</ol>
<p>Neither of these technologies is required for coroutines. For more knowledge about threading, refer to <a class="" href="/cppdev/zh-cn/docs/rpc/krpc/threading_overview">this document</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="q-should-i-use-kthread-extensively-in-my-program">Q: Should I use kthread extensively in my program?<a href="#q-should-i-use-kthread-extensively-in-my-program" class="hash-link" aria-label="Q: Should I use kthread extensively in my program?的直接链接" title="Q: Should I use kthread extensively in my program?的直接链接" translate="no">​</a></h2>
<p>No. Unless you need to <a class="" href="/cppdev/zh-cn/docs/foundamentals/fibers/kthread_or_not">run some code concurrently during a single RPC call</a>, you should avoid directly calling kthread functions—leave these operations to krpc instead, as it handles them more appropriately.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="q-how-do-kthreads-map-to-pthread-workers">Q: How do kthreads map to pthread workers?<a href="#q-how-do-kthreads-map-to-pthread-workers" class="hash-link" aria-label="Q: How do kthreads map to pthread workers?的直接链接" title="Q: How do kthreads map to pthread workers?的直接链接" translate="no">​</a></h2>
<p>A pthread worker runs only one kthread at any given time. When the current kthread suspends:</p>
<ol>
<li class="">The pthread worker first attempts to pop a pending kthread from its local runqueue.</li>
<li class="">If no pending kthread exists locally, it randomly steals pending kthreads from another worker&#x27;s runqueue.</li>
<li class="">If no kthreads are available to steal, the pthread worker sleeps and will be woken up when new pending kthreads are added.</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="q-can-blocking-pthread-or-system-functions-be-called-within-a-kthread">Q: Can blocking pthread or system functions be called within a kthread?<a href="#q-can-blocking-pthread-or-system-functions-be-called-within-a-kthread" class="hash-link" aria-label="Q: Can blocking pthread or system functions be called within a kthread?的直接链接" title="Q: Can blocking pthread or system functions be called within a kthread?的直接链接" translate="no">​</a></h2>
<p>Yes. Only the current pthread worker is blocked; other pthread workers remain unaffected.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="q-does-a-blocked-kthread-affect-other-kthreads">Q: Does a blocked kthread affect other kthreads?<a href="#q-does-a-blocked-kthread-affect-other-kthreads" class="hash-link" aria-label="Q: Does a blocked kthread affect other kthreads?的直接链接" title="Q: Does a blocked kthread affect other kthreads?的直接链接" translate="no">​</a></h2>
<p>No.</p>
<ul>
<li class="">If a kthread blocks via kthread APIs: It yields the current pthread worker to other kthreads.</li>
<li class="">If a kthread blocks via pthread APIs or system functions: Pending kthreads on the current pthread worker are stolen and executed by other idle pthread workers.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="q-can-kthread-apis-be-called-within-a-pthread">Q: Can kthread APIs be called within a pthread?<a href="#q-can-kthread-apis-be-called-within-a-pthread" class="hash-link" aria-label="Q: Can kthread APIs be called within a pthread?的直接链接" title="Q: Can kthread APIs be called within a pthread?的直接链接" translate="no">​</a></h2>
<p>Yes.</p>
<ul>
<li class="">When kthread APIs are called in a kthread context: They affect the current kthread.</li>
<li class="">When kthread APIs are called in a pthread context: They affect the current pthread.</li>
</ul>
<p>Code using kthread APIs can run directly in pthread contexts without modification.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="q-will-a-large-number-of-kthreads-calling-blocking-pthreadsystem-functions-affect-rpc-execution">Q: Will a large number of kthreads calling blocking pthread/system functions affect RPC execution?<a href="#q-will-a-large-number-of-kthreads-calling-blocking-pthreadsystem-functions-affect-rpc-execution" class="hash-link" aria-label="Q: Will a large number of kthreads calling blocking pthread/system functions affect RPC execution?的直接链接" title="Q: Will a large number of kthreads calling blocking pthread/system functions affect RPC execution?的直接链接" translate="no">​</a></h2>
<p>Yes. For example, if there are 8 pthread workers and all 8 kthreads call the system <code>usleep()</code> function, the RPC code responsible for network I/O (sending/receiving data) will be temporarily unable to run.</p>
<p>As long as the blocking duration is not too long, this is generally <strong>not a significant issue</strong>—after all, all workers are in use, and queuing is the only viable alternative. In krpc, users can mitigate this by increasing the number of workers:</p>
<ul>
<li class="">On the server side: Set <a class="" href="/cppdev/zh-cn/docs/rpc/krpc/server#number-of-worker-threads">ServerOptions.num_threads</a> or the <a href="http://krpc.baidu.com:8765/flags/kthread_concurrency" target="_blank" rel="noopener noreferrer" class="">-kthread_concurrency</a> flag.</li>
<li class="">On the client side: Set the <a href="http://krpc.baidu.com:8765/flags/kthread_concurrency" target="_blank" rel="noopener noreferrer" class="">-kthread_concurrency</a> flag.</li>
</ul>
<p>Are there ways to completely avoid this issue?</p>
<ol>
<li class="">
<p><strong>Dynamically increasing worker count</strong>: This may not work as expected. When a large number of workers are blocked, they are likely waiting for the same resource (e.g., a single mutex). Adding more workers only increases the number of waiters.</p>
</li>
<li class="">
<p><strong>Separating IO threads and worker threads</strong>:</p>
<ul>
<li class="">IO threads handle only network I/O (sending/receiving), while worker threads execute user logic. Even if all worker threads block, IO threads remain unaffected.</li>
<li class="">However, adding an extra layer (IO threads) does not resolve congestion: if all worker threads are stuck, the program will still freeze—only the bottleneck shifts from socket buffers to the message queue between IO threads and worker threads. In other words, IO threads may perform useless work when workers are blocked. This is the true meaning of the earlier statement (&quot;not a significant issue&quot;).</li>
<li class="">Another drawback: Each request requires a context switch from IO threads to worker threads. During high system load, these switches may not be scheduled in a timely manner, leading to longer latency tails.</li>
</ul>
</li>
<li class="">
<p><strong>Limiting maximum concurrency</strong>:</p>
<ul>
<li class="">If the number of concurrently processed requests is kept below the number of workers, the scenario where &quot;all workers are blocked&quot; can be avoided entirely. This is a practical solution (see <a class="" href="/cppdev/zh-cn/docs/rpc/krpc/server#limiting-maximum-concurrency">Limiting Maximum Concurrency</a>).</li>
</ul>
</li>
<li class="">
<p><strong>Offloading blocked workers to an independent thread pool</strong>:</p>
<ul>
<li class="">When the number of blocked workers exceeds a threshold (e.g., 6 out of 8), user code is no longer executed in-place but is dispatched to an independent thread pool. This ensures a few workers remain available to handle RPC I/O even if all user code blocks.</li>
<li class="">Currently, this mechanism is <strong>not implemented in kthread mode</strong> but is available when <a class="" href="/cppdev/zh-cn/docs/rpc/krpc/server#pthread-mode">pthread mode is enabled</a>.</li>
<li class="">Does this mechanism also perform &quot;useless work&quot; when user code is fully blocked? Possibly—but its primary purpose is to avoid deadlocks in extreme cases. For example:<!-- -->
<ul>
<li class="">All user code blocks on a pthread mutex, and the mutex can only be unlocked in an RPC callback. If all workers are blocked, no thread can process the RPC callback, leading to a program-wide deadlock.</li>
</ul>
</li>
<li class="">While most RPC implementations have this potential issue, it rarely occurs in practice. Following the best practice of <strong>avoiding RPC calls within locked sections</strong> completely eliminates this risk.</li>
</ul>
</li>
</ol>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id="q-will-kthread-support-channel-as-in-go">Q: Will kthread support <a href="https://gobyexample.com/channels" target="_blank" rel="noopener noreferrer" class="">Channel</a> (as in Go)?<a href="#q-will-kthread-support-channel-as-in-go" class="hash-link" aria-label="q-will-kthread-support-channel-as-in-go的直接链接" title="q-will-kthread-support-channel-as-in-go的直接链接" translate="no">​</a></h2>
<p>No. A Channel represents a <strong>point-to-point relationship</strong>, but many real-world problems involve multiple points. The most natural solution with Channels is to:</p>
<ul>
<li class="">Assign a &quot;role&quot; to manage a specific task/resource.</li>
<li class="">All other threads send commands to this role via Channels.</li>
</ul>
<p>If a program is divided into N such roles (each responsible for its own task), it can operate in an organized manner. However, using Channels implies splitting the program into distinct roles, which comes with tradeoffs:</p>
<ol>
<li class=""><strong>Context switch overhead</strong>: Any operation requires waiting for the target role to be scheduled, process the command, and respond—even with optimizations for cache locality, this overhead is significant.</li>
<li class=""><strong>Complex code</strong>: Due to business consistency constraints, resources are often bound together, forcing a single role to handle multiple responsibilities. A role cannot perform other tasks while processing one, and tasks may have varying priorities. This leads to extremely complex code with frequent interruptions, jumps, and resumptions.</li>
</ol>
<p>What we typically need is a <strong>buffered Channel</strong>, which acts as a queue for ordered execution. kthread provides <a class="" href="/cppdev/zh-cn/docs/foundamentals/fibers/execution_queue">ExecutionQueue</a> to fulfill this purpose, eliminating the need for Channels.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/foundamentals/fibers/faq.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>编辑此页</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/cppdev/zh-cn/docs/foundamentals/fibers/kthread_or_not"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">Thread Model Selection</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/cppdev/zh-cn/docs/foundamentals/monitor/"><div class="pagination-nav__sublabel">下一页</div><div class="pagination-nav__label">Monitoring</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#q-is-kthread-a-coroutine" class="table-of-contents__link toc-highlight">Q: Is kthread a coroutine?</a></li><li><a href="#q-should-i-use-kthread-extensively-in-my-program" class="table-of-contents__link toc-highlight">Q: Should I use kthread extensively in my program?</a></li><li><a href="#q-how-do-kthreads-map-to-pthread-workers" class="table-of-contents__link toc-highlight">Q: How do kthreads map to pthread workers?</a></li><li><a href="#q-can-blocking-pthread-or-system-functions-be-called-within-a-kthread" class="table-of-contents__link toc-highlight">Q: Can blocking pthread or system functions be called within a kthread?</a></li><li><a href="#q-does-a-blocked-kthread-affect-other-kthreads" class="table-of-contents__link toc-highlight">Q: Does a blocked kthread affect other kthreads?</a></li><li><a href="#q-can-kthread-apis-be-called-within-a-pthread" class="table-of-contents__link toc-highlight">Q: Can kthread APIs be called within a pthread?</a></li><li><a href="#q-will-a-large-number-of-kthreads-calling-blocking-pthreadsystem-functions-affect-rpc-execution" class="table-of-contents__link toc-highlight">Q: Will a large number of kthreads calling blocking pthread/system functions affect RPC execution?</a></li><li><a href="#q-will-kthread-support-channel-as-in-go" class="table-of-contents__link toc-highlight">Q: Will kthread support Channel (as in Go)?</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cppdev/zh-cn/docs/intro">Tutorial</a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="footer__item"><a href="https://x.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div><div class="theme-layout-footer-column col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/cppdev/zh-cn/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/kumo-pub" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Kumo, Inc.</div></div></div></footer></div>
</body>
</html>