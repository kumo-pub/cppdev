"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[2547],{6515:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"foundamentals/testing/gt/quickstart-cmake","title":"Quickstart: Building with CMake","description":"This tutorial aims to get you up and running with GoogleTest using CMake. If","source":"@site/docs/foundamentals/testing/gt/quickstart-cmake.md","sourceDirName":"foundamentals/testing/gt","slug":"/foundamentals/testing/gt/quickstart-cmake","permalink":"/cppdev/zh-cn/docs/foundamentals/testing/gt/quickstart-cmake","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/foundamentals/testing/gt/quickstart-cmake.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Quickstart: Building with Bazel","permalink":"/cppdev/zh-cn/docs/foundamentals/testing/gt/quickstart-bazel"},"next":{"title":"GoogleTest Primer","permalink":"/cppdev/zh-cn/docs/foundamentals/testing/gt/primer"}}');var o=n(4848),i=n(8453);const a={},r="Quickstart: Building with CMake",l={},c=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Set up a project",id:"set-up-a-project",level:2},{value:"Create and run a binary",id:"create-and-run-a-binary",level:2},{value:"Next steps",id:"next-steps",level:2}];function d(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(t.header,{children:(0,o.jsx)(t.h1,{id:"quickstart-building-with-cmake",children:"Quickstart: Building with CMake"})}),"\n",(0,o.jsxs)(t.p,{children:["This tutorial aims to get you up and running with GoogleTest using CMake. If\nyou're using GoogleTest for the first time or need a refresher, we recommend\nthis tutorial as a starting point. If your project uses Bazel, see the\n",(0,o.jsx)(t.a,{href:"/cppdev/zh-cn/docs/foundamentals/testing/gt/quickstart-bazel",children:"Quickstart for Bazel"})," instead."]}),"\n",(0,o.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsx)(t.p,{children:"To complete this tutorial, you'll need:"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsx)(t.li,{children:"A compatible operating system (e.g. Linux, macOS, Windows)."}),"\n",(0,o.jsx)(t.li,{children:"A compatible C++ compiler that supports at least C++17."}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"https://cmake.org/",children:"CMake"})," and a compatible build tool for building the\nproject.","\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:["Compatible build tools include\n",(0,o.jsx)(t.a,{href:"https://www.gnu.org/software/make/",children:"Make"}),",\n",(0,o.jsx)(t.a,{href:"https://ninja-build.org/",children:"Ninja"}),", and others - see\n",(0,o.jsx)(t.a,{href:"https://cmake.org/cmake/help/latest/manual/cmake-generators.7.html",children:"CMake Generators"}),"\nfor more information."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(t.p,{children:["See ",(0,o.jsx)(t.a,{href:"/cppdev/zh-cn/docs/foundamentals/testing/gt/platforms",children:"Supported Platforms"})," for more information about platforms\ncompatible with GoogleTest."]}),"\n",(0,o.jsxs)(t.p,{children:["If you don't already have CMake installed, see the\n",(0,o.jsx)(t.a,{href:"https://cmake.org/install",children:"CMake installation guide"}),"."]}),"\n",(0,o.jsx)(t.admonition,{type:"info",children:(0,o.jsx)(t.p,{children:"Note: The terminal commands in this tutorial show a Unix shell prompt, but the\ncommands work on the Windows command line as well."})}),"\n",(0,o.jsx)(t.h2,{id:"set-up-a-project",children:"Set up a project"}),"\n",(0,o.jsxs)(t.p,{children:["CMake uses a file named ",(0,o.jsx)(t.code,{children:"CMakeLists.txt"})," to configure the build system for a\nproject. You'll use this file to set up your project and declare a dependency on\nGoogleTest."]}),"\n",(0,o.jsx)(t.p,{children:"First, create a directory for your project:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{children:"$ mkdir my_project && cd my_project\n"})}),"\n",(0,o.jsxs)(t.p,{children:["Next, you'll create the ",(0,o.jsx)(t.code,{children:"CMakeLists.txt"})," file and declare a dependency on\nGoogleTest. There are many ways to express dependencies in the CMake ecosystem;\nin this quickstart, you'll use the\n",(0,o.jsxs)(t.a,{href:"https://cmake.org/cmake/help/latest/module/FetchContent.html",children:[(0,o.jsx)(t.code,{children:"FetchContent"})," CMake module"]}),".\nTo do this, in your project directory (",(0,o.jsx)(t.code,{children:"my_project"}),"), create a file named\n",(0,o.jsx)(t.code,{children:"CMakeLists.txt"})," with the following contents:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-cmake",children:'cmake_minimum_required(VERSION 3.14)\nproject(my_project)\n\n# GoogleTest requires at least C++17\nset(CMAKE_CXX_STANDARD 17)\nset(CMAKE_CXX_STANDARD_REQUIRED ON)\n\ninclude(FetchContent)\nFetchContent_Declare(\n  googletest\n  URL https://github.com/google/googletest/archive/03597a01ee50ed33e9dfd640b249b4be3799d395.zip\n)\n# For Windows: Prevent overriding the parent project\'s compiler/linker settings\nset(gtest_force_shared_crt ON CACHE BOOL "" FORCE)\nFetchContent_MakeAvailable(googletest)\n'})}),"\n",(0,o.jsxs)(t.p,{children:["The above configuration declares a dependency on GoogleTest which is downloaded\nfrom GitHub. In the above example, ",(0,o.jsx)(t.code,{children:"03597a01ee50ed33e9dfd640b249b4be3799d395"})," is\nthe Git commit hash of the GoogleTest version to use; we recommend updating the\nhash often to point to the latest version."]}),"\n",(0,o.jsxs)(t.p,{children:["For more information about how to create ",(0,o.jsx)(t.code,{children:"CMakeLists.txt"})," files, see the\n",(0,o.jsx)(t.a,{href:"https://cmake.org/cmake/help/latest/guide/tutorial/index.html",children:"CMake Tutorial"}),"."]}),"\n",(0,o.jsx)(t.h2,{id:"create-and-run-a-binary",children:"Create and run a binary"}),"\n",(0,o.jsx)(t.p,{children:"With GoogleTest declared as a dependency, you can use GoogleTest code within\nyour own project."}),"\n",(0,o.jsxs)(t.p,{children:["As an example, create a file named ",(0,o.jsx)(t.code,{children:"hello_test.cc"})," in your ",(0,o.jsx)(t.code,{children:"my_project"}),"\ndirectory with the following contents:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-cpp",children:'#include <gtest/gtest.h>\n\n// Demonstrate some basic assertions.\nTEST(HelloTest, BasicAssertions) {\n  // Expect two strings not to be equal.\n  EXPECT_STRNE("hello", "world");\n  // Expect equality.\n  EXPECT_EQ(7 * 6, 42);\n}\n'})}),"\n",(0,o.jsxs)(t.p,{children:["GoogleTest provides ",(0,o.jsx)(t.a,{href:"/cppdev/zh-cn/docs/foundamentals/testing/gt/primer#assertions",children:"assertions"})," that you use to test the\nbehavior of your code. The above sample includes the main GoogleTest header file\nand demonstrates some basic assertions."]}),"\n",(0,o.jsxs)(t.p,{children:["To build the code, add the following to the end of your ",(0,o.jsx)(t.code,{children:"CMakeLists.txt"})," file:"]}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-cmake",children:"enable_testing()\n\nadd_executable(\n  hello_test\n  hello_test.cc\n)\ntarget_link_libraries(\n  hello_test\n  GTest::gtest_main\n)\n\ninclude(GoogleTest)\ngtest_discover_tests(hello_test)\n"})}),"\n",(0,o.jsxs)(t.p,{children:["The above configuration enables testing in CMake, declares the C++ test binary\nyou want to build (",(0,o.jsx)(t.code,{children:"hello_test"}),"), and links it to GoogleTest (",(0,o.jsx)(t.code,{children:"gtest_main"}),"). The\nlast two lines enable CMake's test runner to discover the tests included in the\nbinary, using the\n",(0,o.jsxs)(t.a,{href:"https://cmake.org/cmake/help/git-stage/module/GoogleTest.html",children:[(0,o.jsx)(t.code,{children:"GoogleTest"})," CMake module"]}),"."]}),"\n",(0,o.jsx)(t.p,{children:"Now you can build and run your test:"}),"\n",(0,o.jsx)(t.pre,{children:(0,o.jsx)(t.code,{className:"language-bash",children:"<strong>my_project$ cmake -S . -B build</strong>\n-- The C compiler identification is GNU 10.2.1\n-- The CXX compiler identification is GNU 10.2.1\n...\n-- Build files have been written to: .../my_project/build\n\n<strong>my_project$ cmake --build build</strong>\nScanning dependencies of target gtest\n...\n[100%] Built target gmock_main\n\n<strong>my_project$ cd build && ctest</strong>\nTest project .../my_project/build\n    Start 1: HelloTest.BasicAssertions\n1/1 Test #1: HelloTest.BasicAssertions ........   Passed    0.00 sec\n\n100% tests passed, 0 tests failed out of 1\n\nTotal Test time (real) =   0.01 sec\n"})}),"\n",(0,o.jsx)(t.p,{children:"Congratulations! You've successfully built and run a test binary using\nGoogleTest."}),"\n",(0,o.jsx)(t.h2,{id:"next-steps",children:"Next steps"}),"\n",(0,o.jsxs)(t.ul,{children:["\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"/cppdev/zh-cn/docs/foundamentals/testing/gt/primer",children:"Check out the Primer"})," to start learning how to write simple\ntests."]}),"\n",(0,o.jsxs)(t.li,{children:[(0,o.jsx)(t.a,{href:"/cppdev/zh-cn/docs/foundamentals/testing/gt/samples",children:"See the code samples"})," for more examples showing how to use a\nvariety of GoogleTest features."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,o.jsx)(t,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>a,x:()=>r});var s=n(6540);const o={},i=s.createContext(o);function a(e){const t=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function r(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:a(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);