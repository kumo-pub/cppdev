"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[4572],{8453:(e,i,n)=>{n.d(i,{R:()=>l,x:()=>o});var t=n(6540);const r={},s=t.createContext(r);function l(e){const i=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),t.createElement(s.Provider,{value:i},e.children)}},9699:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"testing/benchmark/platform_specific_build_instructions","title":"Platform Specific Build Instructions","description":"Building with GCC","source":"@site/docs/testing/benchmark/platform_specific_build_instructions.md","sourceDirName":"testing/benchmark","slug":"/testing/benchmark/platform_specific_build_instructions","permalink":"/cppdev/zh-cn/docs/testing/benchmark/platform_specific_build_instructions","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/testing/benchmark/platform_specific_build_instructions.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"perf_counters","permalink":"/cppdev/zh-cn/docs/testing/benchmark/perf_counters"},"next":{"title":"Building and installing Python bindings","permalink":"/cppdev/zh-cn/docs/testing/benchmark/python_bindings"}}');var r=n(4848),s=n(8453);const l={},o="Platform Specific Build Instructions",d={},c=[{value:"Building with GCC",id:"building-with-gcc",level:2},{value:"Building with Visual Studio 2015, 2017 or 2022",id:"building-with-visual-studio-2015-2017-or-2022",level:2},{value:"Building with Intel 2015 Update 1 or Intel System Studio Update 4",id:"building-with-intel-2015-update-1-or-intel-system-studio-update-4",level:2},{value:"Building on Solaris",id:"building-on-solaris",level:2}];function a(e){const i={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"platform-specific-build-instructions",children:"Platform Specific Build Instructions"})}),"\n",(0,r.jsx)(i.h2,{id:"building-with-gcc",children:"Building with GCC"}),"\n",(0,r.jsxs)(i.p,{children:["When the library is built using GCC it is necessary to link with the pthread\nlibrary due to how GCC implements ",(0,r.jsx)(i.code,{children:"std::thread"}),". Failing to link to pthread will\nlead to runtime exceptions (unless you're using libc++), not linker errors. See\n",(0,r.jsx)(i.a,{href:"https://github.com/google/benchmark/issues/67",children:"issue #67"})," for more details. You\ncan link to pthread by adding ",(0,r.jsx)(i.code,{children:"-pthread"})," to your linker command. Note, you can\nalso use ",(0,r.jsx)(i.code,{children:"-lpthread"}),", but there are potential issues with ordering of command\nline parameters if you use that."]}),"\n",(0,r.jsxs)(i.p,{children:["On QNX, the pthread library is part of libc and usually included automatically\n(see\n",(0,r.jsx)(i.a,{href:"https://www.qnx.com/developers/docs/7.1/index.html#com.qnx.doc.neutrino.lib_ref/topic/p/pthread_create.html",children:(0,r.jsx)(i.code,{children:"pthread_create()"})}),").\nThere's no separate pthread library to link."]}),"\n",(0,r.jsx)(i.h2,{id:"building-with-visual-studio-2015-2017-or-2022",children:"Building with Visual Studio 2015, 2017 or 2022"}),"\n",(0,r.jsxs)(i.p,{children:["The ",(0,r.jsx)(i.code,{children:"shlwapi"})," library (",(0,r.jsx)(i.code,{children:"-lshlwapi"}),") is required to support a call to ",(0,r.jsx)(i.code,{children:"CPUInfo"})," which reads the registry. Either add ",(0,r.jsx)(i.code,{children:"shlwapi.lib"})," under ",(0,r.jsx)(i.code,{children:"[ Configuration Properties > Linker > Input ]"}),", or use the following:"]}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{children:'// Alternatively, can add libraries using linker options.\n\n// First, Add the path to the generated library files (directory containing the `benchmark.lib`) in `[Configuration Properties > Linker > General > Additional Library Directories]`. Then do the following:\n#ifdef _WIN32\n#pragma comment ( lib, "Shlwapi.lib" )\n#ifdef _DEBUG\n#pragma comment ( lib, "benchmark.lib" )\n#else\n#pragma comment ( lib, "benchmark.lib" )\n#endif\n#endif\n'})}),"\n",(0,r.jsxs)(i.p,{children:["When using the static library, make sure to add ",(0,r.jsx)(i.code,{children:"BENCHMARK_STATIC_DEFINE"})," under ",(0,r.jsx)(i.code,{children:"[Configuration Properties > C/C++ > Preprocessor > Preprocessor Definitions]"})]}),"\n",(0,r.jsx)(i.p,{children:"Can also use the graphical version of CMake:"}),"\n",(0,r.jsxs)(i.ul,{children:["\n",(0,r.jsxs)(i.li,{children:["Open ",(0,r.jsx)(i.code,{children:"CMake GUI"}),"."]}),"\n",(0,r.jsxs)(i.li,{children:["Under ",(0,r.jsx)(i.code,{children:"Where to build the binaries"}),", same path as source plus ",(0,r.jsx)(i.code,{children:"build"}),"."]}),"\n",(0,r.jsxs)(i.li,{children:["Under ",(0,r.jsx)(i.code,{children:"CMAKE_INSTALL_PREFIX"}),", same path as source plus ",(0,r.jsx)(i.code,{children:"install"}),"."]}),"\n",(0,r.jsxs)(i.li,{children:["Click ",(0,r.jsx)(i.code,{children:"Configure"}),", ",(0,r.jsx)(i.code,{children:"Generate"}),", ",(0,r.jsx)(i.code,{children:"Open Project"}),"."]}),"\n",(0,r.jsx)(i.li,{children:"If build fails, try deleting entire directory and starting again, or unticking options to build less."}),"\n"]}),"\n",(0,r.jsx)(i.h2,{id:"building-with-intel-2015-update-1-or-intel-system-studio-update-4",children:"Building with Intel 2015 Update 1 or Intel System Studio Update 4"}),"\n",(0,r.jsx)(i.p,{children:"See instructions for building with Visual Studio. Once built, right click on the solution and change the build to Intel."}),"\n",(0,r.jsx)(i.h2,{id:"building-on-solaris",children:"Building on Solaris"}),"\n",(0,r.jsxs)(i.p,{children:["If you're running benchmarks on solaris, you'll want the kstat library linked in\ntoo (",(0,r.jsx)(i.code,{children:"-lkstat"}),")."]})]})}function h(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}}}]);