"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[5937],{4041:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>u,frontMatter:()=>i,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"foundamentals/json/protobuf","title":"Protobuf-JSON conversion","description":"Based on the jsontopb.h and pbtojson.h headers, this document details the bidirectional conversion functionality between Protobuf (PB) and JSON in Merak, including usage methods, advanced configurations, and precautions\u2014maintaining the same structure and style as Merak\'s official documentation.","source":"@site/docs/foundamentals/json/protobuf.mdx","sourceDirName":"foundamentals/json","slug":"/foundamentals/json/protobuf","permalink":"/cppdev/docs/foundamentals/json/protobuf","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Performance","permalink":"/cppdev/docs/foundamentals/json/performance"},"next":{"title":"RPC Overview","permalink":"/cppdev/docs/rpc/"}}');var r=s(4848),t=s(8453);const i={},d="Protobuf-JSON conversion",l={},c=[{value:"Overview",id:"overview",level:2},{value:"Core Features",id:"core-features",level:3},{value:"Dependencies",id:"dependencies",level:3},{value:"1. JSON to Protobuf (<code>json_to_pb.h</code>)",id:"1-json-to-protobuf-json_to_pbh",level:2},{value:"1.1 Basic Usage",id:"11-basic-usage",level:3},{value:"Step 1: Define Protobuf Message",id:"step-1-define-protobuf-message",level:4},{value:"Step 2: Convert JSON to Protobuf Message",id:"step-2-convert-json-to-protobuf-message",level:4},{value:"1.2 Core Configuration: <code>JsonToPbOptions</code>",id:"12-core-configuration-jsontopboptions",level:3},{value:"1.3 Field Mapping Rules",id:"13-field-mapping-rules",level:3},{value:"1.4 Error Handling",id:"14-error-handling",level:3},{value:"2. Protobuf to JSON (<code>pb_to_json.h</code>)",id:"2-protobuf-to-json-pb_to_jsonh",level:2},{value:"2.1 Basic Usage",id:"21-basic-usage",level:3},{value:"2.2 Core Configuration: <code>PbToJsonOptions</code>",id:"22-core-configuration-pbtojsonoptions",level:3},{value:"2.3 Field Mapping Rules",id:"23-field-mapping-rules",level:3},{value:"2.4 Error Handling",id:"24-error-handling",level:3},{value:"3. Advanced Features",id:"3-advanced-features",level:2},{value:"3.1 Handling Dynamic Protobuf Messages",id:"31-handling-dynamic-protobuf-messages",level:3},{value:"3.2 Custom Field Mapping",id:"32-custom-field-mapping",level:3},{value:"3.3 Performance Optimization Tips",id:"33-performance-optimization-tips",level:3},{value:"4. API Reference",id:"4-api-reference",level:2},{value:"4.1 Core APIs in <code>json_to_pb.h</code>",id:"41-core-apis-in-json_to_pbh",level:3},{value:"1. Convert JSON String to Protobuf Message",id:"1-convert-json-string-to-protobuf-message",level:4},{value:"2. Convert Merak DOM to Protobuf Message",id:"2-convert-merak-dom-to-protobuf-message",level:4},{value:"3. Dynamic Message Conversion (via Descriptor)",id:"3-dynamic-message-conversion-via-descriptor",level:4},{value:"4. Error Information Interfaces",id:"4-error-information-interfaces",level:4},{value:"4.2 Core APIs in <code>pb_to_json.h</code>",id:"42-core-apis-in-pb_to_jsonh",level:3},{value:"1. Convert Protobuf Message to JSON String",id:"1-convert-protobuf-message-to-json-string",level:4},{value:"2. Convert Protobuf Message to Merak DOM",id:"2-convert-protobuf-message-to-merak-dom",level:4},{value:"3. Error Information Interfaces",id:"3-error-information-interfaces",level:4},{value:"5. Precautions",id:"5-precautions",level:2},{value:"6. Frequently Asked Questions (FAQs)",id:"6-frequently-asked-questions-faqs",level:2},{value:"Q1: What happens if a required Protobuf field is missing in JSON?",id:"q1-what-happens-if-a-required-protobuf-field-is-missing-in-json",level:3},{value:"Q2: How are Protobuf <code>oneof</code> fields represented in JSON?",id:"q2-how-are-protobuf-oneof-fields-represented-in-json",level:3},{value:"Q3: How to handle Protobuf <code>bytes</code> fields?",id:"q3-how-to-handle-protobuf-bytes-fields",level:3},{value:"Q4: Does Merak&#39;s in situ parsing support JSON-to-PB conversion?",id:"q4-does-meraks-in-situ-parsing-support-json-to-pb-conversion",level:3},{value:"Q5: How to format the converted JSON output?",id:"q5-how-to-format-the-converted-json-output",level:3}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"protobuf-json-conversion",children:"Protobuf-JSON conversion"})}),"\n",(0,r.jsxs)(n.p,{children:["Based on the ",(0,r.jsx)(n.code,{children:"json_to_pb.h"})," and ",(0,r.jsx)(n.code,{children:"pb_to_json.h"})," headers, this document details the bidirectional conversion functionality between Protobuf (PB) and JSON in Merak, including usage methods, advanced configurations, and precautions\u2014maintaining the same structure and style as Merak's official documentation."]}),"\n",(0,r.jsx)(n.p,{children:"[TOC]"}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"json_to_pb.h"})," and ",(0,r.jsx)(n.code,{children:"pb_to_json.h"})," provide efficient conversion capabilities between Protobuf messages and Merak JSON DOM (",(0,r.jsx)(n.code,{children:"Document"}),"/",(0,r.jsx)(n.code,{children:"Value"}),") or JSON strings. They support core Protobuf features (nested messages, repeated fields, enums, oneofs, map fields, etc.) and are compatible with Merak's high-performance design philosophy."]}),"\n",(0,r.jsx)(n.h3,{id:"core-features",children:"Core Features"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Full Type Mapping"}),": Accurate mapping between all Protobuf basic types (",(0,r.jsx)(n.code,{children:"int32"}),"/",(0,r.jsx)(n.code,{children:"int64"}),"/",(0,r.jsx)(n.code,{children:"uint32"}),"/",(0,r.jsx)(n.code,{children:"uint64"}),"/",(0,r.jsx)(n.code,{children:"double"}),"/",(0,r.jsx)(n.code,{children:"float"}),"/",(0,r.jsx)(n.code,{children:"bool"}),"/",(0,r.jsx)(n.code,{children:"string"}),"/",(0,r.jsx)(n.code,{children:"bytes"}),") and JSON types."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Protobuf Feature Support"}),": Seamlessly handles nested messages, repeated fields (",(0,r.jsx)(n.code,{children:"repeated"}),"), enums, oneofs, map fields (",(0,r.jsx)(n.code,{children:"map<>"}),"), required fields, and optional fields."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Flexible Configuration"}),": Offers conversion options (e.g., ignore unknown fields, control default value output, enum conversion modes)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Error Handling"}),": Returns clear conversion status and supports detailed error information (e.g., field mismatch, type error, missing required fields)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"High Performance"}),": Reuses Merak DOM's memory-optimized design for low-overhead conversion, suitable for large-scale data scenarios."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"dependencies",children:"Dependencies"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Depends on Merak core libraries (",(0,r.jsx)(n.code,{children:"document.h"}),"/",(0,r.jsx)(n.code,{children:"value.h"}),"/",(0,r.jsx)(n.code,{children:"stringbuffer.h"}),", etc.)."]}),"\n",(0,r.jsxs)(n.li,{children:["Depends on Protobuf library (version 3.0+ recommended); requires linking against Protobuf compiled artifacts (",(0,r.jsx)(n.code,{children:"libprotobuf"}),")."]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"1-json-to-protobuf-json_to_pbh",children:["1. JSON to Protobuf (",(0,r.jsx)(n.code,{children:"json_to_pb.h"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"json_to_pb.h"})," provides interfaces to convert from Merak JSON DOM or JSON strings to Protobuf messages, core functionality being mapping JSON structures and values to corresponding fields in Protobuf messages."]}),"\n",(0,r.jsx)(n.h3,{id:"11-basic-usage",children:"1.1 Basic Usage"}),"\n",(0,r.jsx)(n.h4,{id:"step-1-define-protobuf-message",children:"Step 1: Define Protobuf Message"}),"\n",(0,r.jsxs)(n.p,{children:["First, write a ",(0,r.jsx)(n.code,{children:".proto"})," file (example: ",(0,r.jsx)(n.code,{children:"user.proto"}),") to define the target Protobuf message structure:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-proto",children:'syntax = "proto3";\n\npackage example;\n\n// Nested message: Address information\nmessage Address {\n  string street = 1;    // Street\n  string city = 2;      // City\n  uint32 zip_code = 3;  // Zip code (optional)\n}\n\n// Enum: User status\nenum UserStatus {\n  STATUS_UNKNOWN = 0;  // Default enum value\n  STATUS_ACTIVE = 1;   // Active\n  STATUS_INACTIVE = 2; // Inactive\n}\n\n// Core message: User information\nmessage User {\n  string id = 1;                  // User ID (required)\n  string name = 2;                // User name (required)\n  uint32 age = 3;                 // Age (optional)\n  bool is_vip = 4;                // Whether VIP (default: false)\n  repeated string tags = 5;        // Tags (repeated field)\n  repeated Address addresses = 6;  // Address list (nested repeated message)\n  UserStatus status = 7;           // User status (enum)\n  map<string, string> ext_info = 8;// Extended information (map field)\n\n  // Oneof field: Contact method (mutually exclusive)\n  oneof contact {\n    string phone = 9;  // Phone number\n    string email = 10; // Email address\n  }\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Compile the ",(0,r.jsx)(n.code,{children:".proto"})," file to generate C++ headers and source files (requires Protobuf compiler ",(0,r.jsx)(n.code,{children:"protoc"}),"):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"protoc --cpp_out=./ user.proto\n"})}),"\n",(0,r.jsxs)(n.p,{children:["This generates ",(0,r.jsx)(n.code,{children:"user.pb.h"})," and ",(0,r.jsx)(n.code,{children:"user.pb.cc"}),"\u2014include these in your project and link against the compiled artifacts."]}),"\n",(0,r.jsx)(n.h4,{id:"step-2-convert-json-to-protobuf-message",children:"Step 2: Convert JSON to Protobuf Message"}),"\n",(0,r.jsxs)(n.p,{children:["Use the ",(0,r.jsx)(n.code,{children:"JsonToPb"})," series of interfaces for conversion, supporting input from either JSON strings or Merak DOM:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include "merak/proto/json_to_pb.h"\n#include "merak/json/document.h"\n#include "user.pb.h"  // Compiled Protobuf header\n#include <iostream>\n\nusing namespace merak::json;\nusing namespace example;\n\nint main() {\n  // 1. JSON string to convert\n  const char* json_str = R"(\n  {\n    "id": "user_123",\n    "name": "Alice",\n    "age": 28,\n    "is_vip": true,\n    "tags": ["student", "tech"],\n    "addresses": [\n      {\n        "street": "123 Main St",\n        "city": "New York",\n        "zip_code": 10001\n      }\n    ],\n    "status": "STATUS_ACTIVE",\n    "ext_info": {\n      "school": "NYU",\n      "major": "CS"\n    },\n    "email": "alice@example.com"\n  }\n  )";\n\n  // 2. Parse JSON string to Merak DOM (optional; direct string conversion is simpler)\n  Document json_doc;\n  if (json_doc.Parse(json_str).HasParseError()) {\n    std::cerr << "JSON parse error: " << GetParseError_En(json_doc.GetParseErrorCode()) << std::endl;\n    return 1;\n  }\n\n  // 3. Initialize Protobuf message\n  User user_pb;\n\n  // 4. Configure conversion options (omit for default)\n  merak::proto::JsonToPbOptions options;\n  options.ignore_unknown_fields = true;  // Ignore fields in JSON not defined in Protobuf\n  options.strict_required_fields = true; // Strictly check required fields (default: true)\n  options.enum_parse_mode = merak::proto::EnumParseMode::kEnumParseName; // Parse enums by name (default)\n\n  // 5. Perform conversion (two input modes: DOM or JSON string)\n  // Mode 1: Convert from Merak DOM\n  bool success = merak::proto::JsonToPb(json_doc, &user_pb, options);\n  // Mode 2: Convert directly from JSON string (internal DOM parsing)\n  // bool success = merak::proto::JsonToPb(json_str, &user_pb, options);\n\n  if (!success) {\n    std::cerr << "JSON to Protobuf failed: " << merak::proto::GetJsonToPbError() << std::endl;\n    return 1;\n  }\n\n  // 6. Verify conversion result\n  std::cout << "Conversion successful. User ID: " << user_pb.id() << std::endl;\n  std::cout << "User status: " << user_pb.status() << std::endl;\n  std::cout << "Email: " << user_pb.email() << std::endl;\n\n  return 0;\n}\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"12-core-configuration-jsontopboptions",children:["1.2 Core Configuration: ",(0,r.jsx)(n.code,{children:"JsonToPbOptions"})]}),"\n",(0,r.jsx)(n.p,{children:"The configuration struct controls JSON-to-PB behavior. Field descriptions:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field Name"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Default Value"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ignore_unknown_fields"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsx)(n.td,{children:"Whether to ignore fields in JSON not defined in Protobuf (true: ignore; false: fail conversion)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"strict_required_fields"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"true"})}),(0,r.jsxs)(n.td,{children:["Whether to strictly check Protobuf ",(0,r.jsx)(n.code,{children:"required"})," fields (true: fail if missing; false: allow missing)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"enum_parse_mode"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"EnumParseMode"})," (enum)"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"kEnumParseName"})}),(0,r.jsxs)(n.td,{children:["Enum parsing mode:",(0,r.jsx)("br",{}),"- ",(0,r.jsx)(n.code,{children:"kEnumParseName"}),': Parse by enum name (e.g., "STATUS_ACTIVE")',(0,r.jsx)("br",{}),"- ",(0,r.jsx)(n.code,{children:"kEnumParseNumber"}),": Parse by enum number (e.g., 1)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"allow_hex_numbers"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsxs)(n.td,{children:["Whether to allow hexadecimal numbers in JSON (true: support ",(0,r.jsx)(n.code,{children:"0x123"}),"; false: decimal only)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bytes_parse_mode"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"BytesParseMode"})," (enum)"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"kBytesParseBase64"})}),(0,r.jsxs)(n.td,{children:["Parsing mode for Protobuf ",(0,r.jsx)(n.code,{children:"bytes"})," fields:",(0,r.jsx)("br",{}),"- ",(0,r.jsx)(n.code,{children:"kBytesParseBase64"}),": Decode JSON string as Base64",(0,r.jsx)("br",{}),"- ",(0,r.jsx)(n.code,{children:"kBytesParseRaw"}),": Treat JSON string as raw bytes"]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"13-field-mapping-rules",children:"1.3 Field Mapping Rules"}),"\n",(0,r.jsx)(n.p,{children:"Type mapping between JSON and Protobuf follows the official Protobuf JSON specification. Core mappings:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Protobuf Field Type"}),(0,r.jsx)(n.th,{children:"JSON Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"int32"}),"/",(0,r.jsx)(n.code,{children:"int64"}),"/",(0,r.jsx)(n.code,{children:"uint32"}),"/",(0,r.jsx)(n.code,{children:"uint64"})]}),(0,r.jsx)(n.td,{children:"Number or String"}),(0,r.jsx)(n.td,{children:'Supports JSON numbers (e.g., 123) or strings (e.g., "123"); conversion fails if out of range'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"double"}),"/",(0,r.jsx)(n.code,{children:"float"})]}),(0,r.jsx)(n.td,{children:"Number or String"}),(0,r.jsx)(n.td,{children:'Supports JSON numbers (e.g., 3.14) or strings (e.g., "3.14"); NaN/Inf not supported'})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:"Boolean or String"}),(0,r.jsxs)(n.td,{children:["Supports JSON ",(0,r.jsx)(n.code,{children:"true"}),"/",(0,r.jsx)(n.code,{children:"false"}),', or strings "true"/"false" (case-insensitive)']})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"string"})}),(0,r.jsx)(n.td,{children:"String"}),(0,r.jsxs)(n.td,{children:["Supports JSON strings with null characters (",(0,r.jsx)(n.code,{children:"\\u0000"}),") (compliant with Merak features)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bytes"})}),(0,r.jsx)(n.td,{children:"String"}),(0,r.jsxs)(n.td,{children:["Defaults to Base64-encoded string; configurable to raw bytes via ",(0,r.jsx)(n.code,{children:"bytes_parse_mode"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"enum"})}),(0,r.jsx)(n.td,{children:"String or Number"}),(0,r.jsxs)(n.td,{children:['Maps to enum name (e.g., "STATUS_ACTIVE") or number (e.g., 1), depending on ',(0,r.jsx)(n.code,{children:"enum_parse_mode"})]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"repeated T"})}),(0,r.jsx)(n.td,{children:"Array"}),(0,r.jsx)(n.td,{children:"Each element in the JSON array follows the mapping rule for type T"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["Nested ",(0,r.jsx)(n.code,{children:"message"})]}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsx)(n.td,{children:"Fields in the JSON object map one-to-one with fields in the nested message"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"map<K, V>"})}),(0,r.jsx)(n.td,{children:"Object"}),(0,r.jsxs)(n.td,{children:["Keys are of type K (supports ",(0,r.jsx)(n.code,{children:"string"}),"/",(0,r.jsx)(n.code,{children:"int32"}),"/",(0,r.jsx)(n.code,{children:"int64"}),"/",(0,r.jsx)(n.code,{children:"uint32"}),"/",(0,r.jsx)(n.code,{children:"uint64"}),"); values are of type V"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"oneof"})}),(0,r.jsx)(n.td,{children:"Single Field"}),(0,r.jsx)(n.td,{children:"Only one field from the oneof is allowed in JSON; conversion fails if multiple or none are present"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"14-error-handling",children:"1.4 Error Handling"}),"\n",(0,r.jsx)(n.p,{children:"For conversion failures, retrieve detailed error information via:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"const char* GetJsonToPbError()"}),": Returns human-readable error description (e.g., \"required field 'id' not found\")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"int GetJsonToPbErrorCode()"}),": Returns error code (corresponds to ",(0,r.jsx)(n.code,{children:"JsonToPbErrorCode"})," enum, e.g., ",(0,r.jsx)(n.code,{children:"kJsonToPbErrorMissingRequiredField"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Common Error Types:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Missing required Protobuf fields."}),"\n",(0,r.jsxs)(n.li,{children:["Mismatched field types (e.g., JSON string assigned to PB ",(0,r.jsx)(n.code,{children:"int32"})," field)."]}),"\n",(0,r.jsx)(n.li,{children:"Invalid enum values (e.g., unknown enum name or number)."}),"\n",(0,r.jsx)(n.li,{children:"Oneof field conflict (multiple oneof fields present in JSON)."}),"\n",(0,r.jsxs)(n.li,{children:["Inconsistent types in JSON array (e.g., ",(0,r.jsx)(n.code,{children:"repeated int32"})," mapped to JSON array with strings)."]}),"\n"]}),"\n",(0,r.jsxs)(n.h2,{id:"2-protobuf-to-json-pb_to_jsonh",children:["2. Protobuf to JSON (",(0,r.jsx)(n.code,{children:"pb_to_json.h"}),")"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"pb_to_json.h"})," provides interfaces to convert from Protobuf messages to Merak JSON DOM or JSON strings, supporting advanced features like output format control and default value handling."]}),"\n",(0,r.jsx)(n.h3,{id:"21-basic-usage",children:"2.1 Basic Usage"}),"\n",(0,r.jsx)(n.p,{children:"Using the Protobuf message defined in Section 1.1, convert the PB message to JSON:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include "merak/proto/pb_to_json.h"\n#include "merak/json/document.h"\n#include "merak/json/stringbuffer.h"\n#include "merak/json/writer.h"\n#include "user.pb.h"\n#include <iostream>\n\nusing namespace merak::json;\nusing namespace example;\n\nint main() {\n  // 1. Construct Protobuf message\n  User user_pb;\n  user_pb.set_id("user_456");\n  user_pb.set_name("Bob");\n  user_pb.set_age(30);\n  user_pb.set_is_vip(false);\n  user_pb.add_tags("engineer");\n  user_pb.add_tags("golang");\n\n  // Add nested address message\n  Address* addr = user_pb.add_addresses();\n  addr->set_street("456 Oak Ave");\n  addr->set_city("London");\n  addr->set_zip_code(EC1V 9LB);\n\n  user_pb.set_status(UserStatus::STATUS_ACTIVE);\n  user_pb.mutable_ext_info()->insert({"company", "ABC Corp"});\n  user_pb.set_phone("+44 1234567890"); // Set oneof field\n\n  // 2. Configure conversion options\n  merak::proto::PbToJsonOptions options;\n  options.output_default_values = false;  // Do not output default-valued fields (default: false)\n  options.enum_output_mode = merak::proto::EnumOutputMode::kEnumOutputName; // Output enum names (default)\n  options.use_proto_field_name = false;   // Use JSON field names (default: false; uses proto-defined names)\n  options.pretty_print = true;           // Format JSON output (default: false)\n  options.bytes_output_mode = merak::proto::BytesOutputMode::kBytesOutputBase64; // Output bytes as Base64 (default)\n\n  // 3. Perform conversion (two output modes: Merak DOM or JSON string)\n  // Mode 1: Convert to Merak DOM (modifiable)\n  Document json_doc;\n  bool success = merak::proto::PbToJson(user_pb, &json_doc, options);\n  if (!success) {\n    std::cerr << "Protobuf to JSON failed: " << merak::proto::GetPbToJsonError() << std::endl;\n    return 1;\n  }\n\n  // Mode 2: Convert directly to JSON string (simpler)\n  // std::string json_str;\n  // bool success = merak::proto::PbToJson(user_pb, &json_str, options);\n\n  // 4. Output JSON result (formatted)\n  StringBuffer buffer;\n  PrettyWriter<StringBuffer> writer(buffer); // Formatted writer\n  json_doc.Accept(writer);\n\n  std::cout << "Protobuf to JSON result:" << std::endl;\n  std::cout << buffer.GetString() << std::endl;\n\n  return 0;\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"Output (formatted):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "id": "user_456",\n    "name": "Bob",\n    "age": 30,\n    "is_vip": false,\n    "tags": ["engineer", "golang"],\n    "addresses": [\n        {\n            "street": "456 Oak Ave",\n            "city": "London",\n            "zip_code": 234567890\n        }\n    ],\n    "status": "STATUS_ACTIVE",\n    "ext_info": {\n        "company": "ABC Corp"\n    },\n    "phone": "+44 1234567890"\n}\n'})}),"\n",(0,r.jsxs)(n.h3,{id:"22-core-configuration-pbtojsonoptions",children:["2.2 Core Configuration: ",(0,r.jsx)(n.code,{children:"PbToJsonOptions"})]}),"\n",(0,r.jsx)(n.p,{children:"Controls PB-to-JSON output behavior. Field descriptions:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Field Name"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Default Value"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"output_default_values"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsx)(n.td,{children:"Whether to output Protobuf default values (true: output; false: omit default-valued fields)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"enum_output_mode"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"EnumOutputMode"})," (enum)"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"kEnumOutputName"})}),(0,r.jsxs)(n.td,{children:["Enum output mode:",(0,r.jsx)("br",{}),"- ",(0,r.jsx)(n.code,{children:"kEnumOutputName"}),': Output enum names (e.g., "STATUS_ACTIVE")',(0,r.jsx)("br",{}),"- ",(0,r.jsx)(n.code,{children:"kEnumOutputNumber"}),": Output enum numbers (e.g., 1)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"use_proto_field_name"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsxs)(n.td,{children:["Whether to use Protobuf-defined field names (true: use proto names; false: use JSON-spec names, e.g., proto ",(0,r.jsx)(n.code,{children:"user_name"})," \u2192 JSON ",(0,r.jsx)(n.code,{children:"userName"}),")"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"pretty_print"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsx)(n.td,{children:"Whether to format JSON with indentation and line breaks (true: formatted; false: compact)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bytes_output_mode"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:"BytesOutputMode"})," (enum)"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"kBytesOutputBase64"})}),(0,r.jsxs)(n.td,{children:["Output mode for Protobuf ",(0,r.jsx)(n.code,{children:"bytes"})," fields:",(0,r.jsx)("br",{}),"- ",(0,r.jsx)(n.code,{children:"kBytesOutputBase64"}),": Output as Base64 string",(0,r.jsx)("br",{}),"- ",(0,r.jsx)(n.code,{children:"kBytesOutputRaw"}),": Output as raw byte string (may contain non-printable characters)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ignore_empty_repeated"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsxs)(n.td,{children:["Whether to omit empty ",(0,r.jsx)(n.code,{children:"repeated"})," fields (true: omit empty arrays; false: output empty arrays)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"ignore_empty_map"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"bool"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})}),(0,r.jsxs)(n.td,{children:["Whether to omit empty ",(0,r.jsx)(n.code,{children:"map"})," fields (true: omit empty objects; false: output empty objects)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"max_depth"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"int"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"100"})}),(0,r.jsx)(n.td,{children:"Maximum nesting depth for nested messages (prevents recursion overflow; conversion fails if exceeded)"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"23-field-mapping-rules",children:"2.3 Field Mapping Rules"}),"\n",(0,r.jsx)(n.p,{children:"Mapping from Protobuf to JSON follows symmetric rules to JSON-to-PB. Key supplementary notes:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Default Value Handling"}),": Default-valued fields (e.g., ",(0,r.jsx)(n.code,{children:"int32"})," = 0, ",(0,r.jsx)(n.code,{children:"bool"})," = false, ",(0,r.jsx)(n.code,{children:"string"}),' = "") are omitted by default; enable via ',(0,r.jsx)(n.code,{children:"output_default_values"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Repeated Fields"}),": Protobuf ",(0,r.jsx)(n.code,{children:"repeated"})," fields always map to JSON arrays (empty arrays are omitted or retained per ",(0,r.jsx)(n.code,{children:"ignore_empty_repeated"}),")."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Oneof Fields"}),": Only the set field in the oneof is output (omitted if no field is set)."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Map Fields"}),": Protobuf ",(0,r.jsx)(n.code,{children:"map<K, V>"})," maps to JSON objects, with keys as string representations of K (e.g., ",(0,r.jsx)(n.code,{children:"int32"}),' key 123 \u2192 "123").']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enum Fields"}),': Enum names are output by default (e.g., "STATUS_ACTIVE"); switch to numbers via ',(0,r.jsx)(n.code,{children:"enum_output_mode"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"24-error-handling",children:"2.4 Error Handling"}),"\n",(0,r.jsx)(n.p,{children:"For conversion failures, retrieve error information via:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"const char* GetPbToJsonError()"}),': Returns error description (e.g., "nested message depth exceeds max_depth").']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"int GetPbToJsonErrorCode()"}),": Returns error code (corresponds to ",(0,r.jsx)(n.code,{children:"PbToJsonErrorCode"})," enum, e.g., ",(0,r.jsx)(n.code,{children:"kPbToJsonErrorMaxDepthExceeded"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Common Error Types:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Nested message depth exceeds ",(0,r.jsx)(n.code,{children:"max_depth"})," limit."]}),"\n",(0,r.jsx)(n.li,{children:"Protobuf message contains uninitialized required fields (checked only in debug mode)."}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"bytes"})," field contains invalid Base64 characters (when ",(0,r.jsx)(n.code,{children:"bytes_output_mode"})," = ",(0,r.jsx)(n.code,{children:"kBytesOutputBase64"}),")."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"3-advanced-features",children:"3. Advanced Features"}),"\n",(0,r.jsx)(n.h3,{id:"31-handling-dynamic-protobuf-messages",children:"3.1 Handling Dynamic Protobuf Messages"}),"\n",(0,r.jsxs)(n.p,{children:["Supports dynamic messages via Protobuf's ",(0,r.jsx)(n.code,{children:"Descriptor"})," and ",(0,r.jsx)(n.code,{children:"Reflection"})," interfaces (no compiled ",(0,r.jsx)(n.code,{children:".proto"})," code required):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'#include "merak/proto/json_to_pb.h"\n#include "google/protobuf/descriptor.h"\n#include "google/protobuf/message.h"\n\n// Dynamic JSON-to-Protobuf conversion (Descriptor known)\nbool DynamicJsonToPb(const Document& json, const google::protobuf::Descriptor* desc, google::protobuf::Message* pb) {\n  return merak::proto::JsonToPb(json, desc, pb, merak::proto::JsonToPbOptions());\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"32-custom-field-mapping",children:"3.2 Custom Field Mapping"}),"\n",(0,r.jsx)(n.p,{children:"Register callback functions to customize conversion logic for specific fields (e.g., special date formats, custom enum mappings):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:'// Register field conversion callback (example: convert JSON date string to Protobuf int64 timestamp)\nmerak::proto::RegisterJsonToPbFieldCallback(\n  "example.User",  // Full message type name\n  "create_time",  // Field name\n  [](const Value& json_val, google::protobuf::Message* pb, const google::protobuf::FieldDescriptor* field) -> bool {\n    if (!json_val.IsString()) return false;\n    // Custom logic: convert "2024-01-01" to timestamp\n    int64_t timestamp = ParseDateToTimestamp(json_val.GetString());\n    pb->GetReflection()->SetInt64(pb, field, timestamp);\n    return true;\n  }\n);\n'})}),"\n",(0,r.jsx)(n.h3,{id:"33-performance-optimization-tips",children:"3.3 Performance Optimization Tips"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reuse DOM Objects"}),": For frequent conversions, reuse Merak ",(0,r.jsx)(n.code,{children:"Document"})," objects (clear via ",(0,r.jsx)(n.code,{children:"SetObject()"}),"/",(0,r.jsx)(n.code,{children:"SetArray()"}),") to reduce memory allocation overhead."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Bulk Conversion"}),": For large numbers of small messages, batch conversions and reuse ",(0,r.jsx)(n.code,{children:"StringBuffer"})," to avoid repeated buffer creation."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Disable Unnecessary Checks"}),": In production environments, set ",(0,r.jsx)(n.code,{children:"ignore_unknown_fields = true"})," to reduce field validation overhead."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Use Compact JSON"}),": Disable ",(0,r.jsx)(n.code,{children:"pretty_print"})," for non-human-readable scenarios to reduce string concatenation overhead."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"4-api-reference",children:"4. API Reference"}),"\n",(0,r.jsxs)(n.h3,{id:"41-core-apis-in-json_to_pbh",children:["4.1 Core APIs in ",(0,r.jsx)(n.code,{children:"json_to_pb.h"})]}),"\n",(0,r.jsx)(n.h4,{id:"1-convert-json-string-to-protobuf-message",children:"1. Convert JSON String to Protobuf Message"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"bool JsonToPb(\n  const char* json_str,                  // Input: JSON string\n  google::protobuf::Message* pb_msg,     // Output: Protobuf message (pre-initialized)\n  const JsonToPbOptions& options = JsonToPbOptions()  // Conversion options\n);\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-convert-merak-dom-to-protobuf-message",children:"2. Convert Merak DOM to Protobuf Message"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"bool JsonToPb(\n  const Value& json_val,                 // Input: Merak JSON Value (Object type)\n  google::protobuf::Message* pb_msg,     // Output: Protobuf message\n  const JsonToPbOptions& options = JsonToPbOptions()  // Conversion options\n);\n"})}),"\n",(0,r.jsx)(n.h4,{id:"3-dynamic-message-conversion-via-descriptor",children:"3. Dynamic Message Conversion (via Descriptor)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"bool JsonToPb(\n  const Value& json_val,\n  const google::protobuf::Descriptor* pb_desc,  // Protobuf message descriptor\n  google::protobuf::Message* pb_msg,\n  const JsonToPbOptions& options = JsonToPbOptions()\n);\n"})}),"\n",(0,r.jsx)(n.h4,{id:"4-error-information-interfaces",children:"4. Error Information Interfaces"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"const char* GetJsonToPbError();          // Get description of last conversion error\nint GetJsonToPbErrorCode();              // Get error code of last conversion (JsonToPbErrorCode)\n"})}),"\n",(0,r.jsxs)(n.h3,{id:"42-core-apis-in-pb_to_jsonh",children:["4.2 Core APIs in ",(0,r.jsx)(n.code,{children:"pb_to_json.h"})]}),"\n",(0,r.jsx)(n.h4,{id:"1-convert-protobuf-message-to-json-string",children:"1. Convert Protobuf Message to JSON String"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"bool PbToJson(\n  const google::protobuf::Message& pb_msg,  // Input: Protobuf message\n  std::string* json_str,                    // Output: JSON string\n  const PbToJsonOptions& options = PbToJsonOptions()  // Conversion options\n);\n"})}),"\n",(0,r.jsx)(n.h4,{id:"2-convert-protobuf-message-to-merak-dom",children:"2. Convert Protobuf Message to Merak DOM"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"bool PbToJson(\n  const google::protobuf::Message& pb_msg,  // Input: Protobuf message\n  Value* json_val,                          // Output: Merak JSON Value (Object type)\n  const PbToJsonOptions& options = PbToJsonOptions()  // Conversion options\n);\n"})}),"\n",(0,r.jsx)(n.h4,{id:"3-error-information-interfaces",children:"3. Error Information Interfaces"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-cpp",children:"const char* GetPbToJsonError();          // Get description of last conversion error\nint GetPbToJsonErrorCode();              // Get error code of last conversion (PbToJsonErrorCode)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"5-precautions",children:"5. Precautions"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Protobuf Version Compatibility"}),": Only supports Protobuf 3.0+. Behavior of ",(0,r.jsx)(n.code,{children:"required"}),"/",(0,r.jsx)(n.code,{children:"optional"})," keywords in Protobuf 2.x may not match expectations."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"JSON Field Name Matching"}),": By default, Protobuf field name ",(0,r.jsx)(n.code,{children:"user_name"})," maps to JSON ",(0,r.jsx)(n.code,{children:"userName"})," (camelCase). Force raw field names with ",(0,r.jsx)(n.code,{children:"use_proto_field_name = true"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Enum Compatibility"}),": The default enum value (number 0) must exist (e.g., ",(0,r.jsx)(n.code,{children:"STATUS_UNKNOWN = 0"}),"), otherwise conversion may fail."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Large Data Handling"}),": For extra-large Protobuf messages (e.g., 100MB+), use Merak's ",(0,r.jsx)(n.code,{children:"FileReadStream"}),"/",(0,r.jsx)(n.code,{children:"FileWriteStream"})," for chunked processing to avoid memory overflow."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Thread Safety"}),": Conversion interfaces are not thread-safe. Use separate calls per thread or add lock protection in multi-threaded environments."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Default Value Behavior"}),": All fields in Protobuf 3 are optional by default. Default-valued fields (e.g., 0, false, empty string) are not included in JSON when ",(0,r.jsx)(n.code,{children:"output_default_values = false"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"6-frequently-asked-questions-faqs",children:"6. Frequently Asked Questions (FAQs)"}),"\n",(0,r.jsx)(n.h3,{id:"q1-what-happens-if-a-required-protobuf-field-is-missing-in-json",children:"Q1: What happens if a required Protobuf field is missing in JSON?"}),"\n",(0,r.jsxs)(n.p,{children:["A1: By default (",(0,r.jsx)(n.code,{children:"strict_required_fields = true"}),"), conversion fails with error \"required field 'xxx' not found\". Set ",(0,r.jsx)(n.code,{children:"strict_required_fields = false"})," to allow missing fields (field uses default value in Protobuf message)."]}),"\n",(0,r.jsxs)(n.h3,{id:"q2-how-are-protobuf-oneof-fields-represented-in-json",children:["Q2: How are Protobuf ",(0,r.jsx)(n.code,{children:"oneof"})," fields represented in JSON?"]}),"\n",(0,r.jsx)(n.p,{children:"A2: Only one field from the oneof is allowed in JSON; conversion fails if multiple or none are present (JSON-to-PB). Only the set oneof field is output (PB-to-JSON)."}),"\n",(0,r.jsxs)(n.h3,{id:"q3-how-to-handle-protobuf-bytes-fields",children:["Q3: How to handle Protobuf ",(0,r.jsx)(n.code,{children:"bytes"})," fields?"]}),"\n",(0,r.jsxs)(n.p,{children:["A3: By default, ",(0,r.jsx)(n.code,{children:"bytes"})," fields are represented as Base64 strings in JSON. Switch to raw bytes via ",(0,r.jsx)(n.code,{children:"bytes_parse_mode"})," (JSON-to-PB) and ",(0,r.jsx)(n.code,{children:"bytes_output_mode"})," (PB-to-JSON)."]}),"\n",(0,r.jsx)(n.h3,{id:"q4-does-meraks-in-situ-parsing-support-json-to-pb-conversion",children:"Q4: Does Merak's in situ parsing support JSON-to-PB conversion?"}),"\n",(0,r.jsx)(n.p,{children:"A4: Yes. If the JSON string is parsed into Merak DOM via in situ parsing, conversion to PB requires no additional string copying\u2014offering higher performance."}),"\n",(0,r.jsx)(n.h3,{id:"q5-how-to-format-the-converted-json-output",children:"Q5: How to format the converted JSON output?"}),"\n",(0,r.jsxs)(n.p,{children:["A5: Serialize the DOM with Merak's ",(0,r.jsx)(n.code,{children:"PrettyWriter"}),", or set ",(0,r.jsx)(n.code,{children:"PbToJsonOptions::pretty_print = true"})," to generate formatted JSON strings directly."]})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>d});var o=s(6540);const r={},t=o.createContext(r);function i(e){const n=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);