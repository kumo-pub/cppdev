"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[7196],{4454:(e,t,s)=>{s.r(t),s.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"testing/doct/build-systems","title":"Integration and Building","description":"Build Systems","source":"@site/docs/testing/doct/build-systems.mdx","sourceDirName":"testing/doct","slug":"/testing/doct/build-systems","permalink":"/docs/testing/doct/build-systems","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/testing/doct/build-systems.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"FAQ","permalink":"/docs/testing/doct/faq"},"next":{"title":"Framework Performance","permalink":"/docs/testing/doct/benchmarks"}}');var i=s(4848),r=s(8453);const c={},o="Integration and Building",a={},d=[{value:"Build Systems",id:"build-systems",level:2},{value:"CMake",id:"cmake",level:3},{value:"Package Managers",id:"package-managers",level:3}];function l(e){const t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"integration-and-building",children:"Integration and Building"})}),"\n",(0,i.jsx)(t.h2,{id:"build-systems",children:"Build Systems"}),"\n",(0,i.jsxs)(t.p,{children:["The latest released version of doctest can be obtained from here: ",(0,i.jsx)(t.a,{href:"https://gitee.com/kumo-hub/doctest/raw/master/doctest/doctest.h",children:(0,i.jsx)(t.code,{children:"https://gitee.com/kumo-hub/doctest/raw/master/doctest/doctest.h"})})]}),"\n",(0,i.jsxs)(t.p,{children:["You can replace ",(0,i.jsx)(t.code,{children:"master"})," in the URL above with tags like ",(0,i.jsx)(t.code,{children:"dev"})," or ",(0,i.jsx)(t.code,{children:"v1.4.8"})," for specific versions."]}),"\n",(0,i.jsx)(t.h3,{id:"cmake",children:"CMake"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"doctest"})," is most easily used as a single file in your own repository. The following minimal example will then work:"]}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cmake",children:"cmake_minimum_required(VERSION 3.0)\nproject(cmake_test VERSION 0.0.1 LANGUAGES CXX)\n\n# Prepare doctest for other targets to use\nfind_package(doctest REQUIRED)\n\n# Make test executable\nadd_executable(tests main.cpp)\ntarget_compile_features(tests PRIVATE cxx_std_17)\ntarget_link_libraries(tests PRIVATE doctest::doctest)\n"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["You can also use the following CMake snippet to automatically fetch the entire ",(0,i.jsx)(t.strong,{children:"doctest"})," repository from Gitee and configure it as an external project:"]}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cmake",children:'include(ExternalProject)\nfind_package(Git REQUIRED)\n\nExternalProject_Add(\n    doctest\n    PREFIX ${CMAKE_BINARY_DIR}/doctest\n    GIT_REPOSITORY https://gitee.com/kumo-hub/doctest.git\n    TIMEOUT 10\n    UPDATE_COMMAND ${GIT_EXECUTABLE} pull\n    CONFIGURE_COMMAND ""\n    BUILD_COMMAND ""\n    INSTALL_COMMAND ""\n    LOG_DOWNLOAD ON\n)\n\n# Expose required variable (DOCTEST_INCLUDE_DIR) to parent scope\nExternalProject_Get_Property(doctest source_dir)\nset(DOCTEST_INCLUDE_DIR ${source_dir}/doctest CACHE INTERNAL "Path to include folder for doctest")\n'})}),"\n",(0,i.jsx)(t.p,{children:"Later you will be able to use the doctest include directory as follows:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cmake",children:"# add it globally\ninclude_directories(${DOCTEST_INCLUDE_DIR})\n\n# or per target\ntarget_include_directories(my_target PUBLIC ${DOCTEST_INCLUDE_DIR})\n"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["If you have the entire doctest repository (as a submodule or files), you can also include it in your CMake build with ",(0,i.jsx)(t.code,{children:"add_subdirectory(path/to/doctest)"}),", then you can use it like this:"]}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-cmake",children:"add_executable(my_tests src_1.cpp src_2.cpp ...)\ntarget_link_libraries(my_tests doctest)\n"})}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:['The "CMakeLists.txt" file of the doctest repository has an ',(0,i.jsx)(t.code,{children:"install()"})," command, so you can also use doctest as a package."]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["\n",(0,i.jsxs)(t.p,{children:["To discover tests from executables and register them with CTest, you can use ",(0,i.jsx)(t.a,{href:"https://github.com/doctest/doctest/blob/master/scripts/cmake/doctest.cmake",children:(0,i.jsx)(t.code,{children:"doctest_discover_tests(<target>)"})})," from ",(0,i.jsx)(t.code,{children:"scripts/cmake/doctest.cmake"})," \u2014 read the comments in the file on how to use it. It works just like the same feature in ",(0,i.jsx)(t.a,{href:"https://github.com/catchorg/Catch2/blob/master/docs/cmake-integration.mdx#automatic-test-registration",children:"Catch"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h3,{id:"package-managers",children:"Package Managers"}),"\n",(0,i.jsxs)(t.p,{children:[(0,i.jsx)(t.strong,{children:"doctest"})," is available via the following package managers:"]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"kmpkg"}),"\n"]}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-sh",children:"kmpkg integrate install\nkmpkg install doctest\n"})}),"\n",(0,i.jsxs)(t.p,{children:["The doctest port in kmpkg is kept up-to-date by members of the ",(0,i.jsx)(t.code,{children:"Kumo"})," team. If the version is outdated, please create an issue or pull request on the ",(0,i.jsx)(t.a,{href:"https://gitee.com/kumo-pub/kmpkg",children:"kmpkg repository"}),"."]}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"hunter"}),"\n",(0,i.jsxs)(t.li,{children:["conan","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://conan.io/center/doctest",children:"https://conan.io/center/doctest"})}),"\n",(0,i.jsx)(t.li,{children:(0,i.jsx)(t.a,{href:"https://github.com/conan-io/conan-center-index/tree/master/recipes/doctest",children:"https://github.com/conan-io/conan-center-index/tree/master/recipes/doctest"})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(t.li,{children:["Homebrew (",(0,i.jsx)(t.code,{children:"brew install doctest"}),")"]}),"\n"]}),"\n",(0,i.jsx)(t.admonition,{title:"IMPORTANT",type:"warning",children:(0,i.jsxs)(t.p,{children:["The version installed via kmpkg is the mirrored version of ",(0,i.jsx)(t.code,{children:"kumo"})," on GITEE, while versions installed via other package managers are the official versions. There is no difference in usage."]})})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,t,s)=>{s.d(t,{R:()=>c,x:()=>o});var n=s(6540);const i={},r=n.createContext(i);function c(e){const t=n.useContext(r);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),n.createElement(r.Provider,{value:t},e.children)}}}]);