"use strict";(globalThis.webpackChunkwebsite=globalThis.webpackChunkwebsite||[]).push([[949],{7734:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>m,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"foundamentals/json/overview","title":"merak json","description":"High-Performance C++ JSON Parser/Generator with SAX and DOM-style APIs","source":"@site/docs/foundamentals/json/overview.mdx","sourceDirName":"foundamentals/json","slug":"/foundamentals/json/overview","permalink":"/cppdev/docs/foundamentals/json/overview","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Overview","permalink":"/cppdev/docs/foundamentals/json/"},"next":{"title":"Features","permalink":"/cppdev/docs/foundamentals/json/features"}}');var i=s(4848),r=s(8453);const a=s.p+"assets/images/simpledom-6f410aeb45d32ae86fae6129ca91c332.png",l={},o="merak json",d={},c=[{value:"High-Performance C++ JSON Parser/Generator with SAX and DOM-style APIs",id:"overview",level:2},{value:"Introduction",id:"introduction",level:2},{value:"Highlights in v1.1 (2016-08-25)",id:"highlights-in-v11-2016-08-25",level:2},{value:"Compatibility",id:"compatibility",level:2},{value:"Installation",id:"installation",level:2},{value:"Steps to Build Tests and Examples",id:"steps-to-build-tests-and-examples",level:3},{value:"Quick Start",id:"quick-start",level:2},{value:"DOM API",id:"dom-api",level:3},{value:"SAX API",id:"sax-api",level:3},{value:"Schema API",id:"schema-api",level:3},{value:"Advanced",id:"advanced",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"merak-json",children:"merak json"})}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"High-Performance C++ JSON Parser/Generator with SAX and DOM-style APIs"}),"\n",(0,i.jsx)(n.p,{children:"merak json is a modified version based on Merak, inheriting the API style of Merak and additionally enhancing support for Protocol Buffers (protobuf)."}),"\n",(0,i.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(n.p,{children:["Merak is a C++ JSON parser and generator, inspired by ",(0,i.jsx)(n.a,{href:"http://rapidxml.sourceforge.net/",children:"RapidXml"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Merak is small yet comprehensive. It supports both SAX and DOM-style APIs. The SAX parser consists of only about 500 lines of code."}),"\n",(0,i.jsxs)(n.li,{children:["Merak is fast. Its performance is comparable to ",(0,i.jsx)(n.code,{children:"strlen()"}),". It supports SSE2/SSE4.2 acceleration."]}),"\n",(0,i.jsx)(n.li,{children:"Merak is self-contained. It does not depend on external libraries such as BOOST, or even the Standard Template Library (STL)."}),"\n",(0,i.jsx)(n.li,{children:"Merak is memory-efficient. On most 32/64-bit machines, each JSON value occupies only 16 bytes (excluding strings). It uses a high-speed memory allocator by default, enabling the parser to allocate memory compactly."}),"\n",(0,i.jsxs)(n.li,{children:["Merak is Unicode-friendly. It supports UTF-8, UTF-16, UTF-32 (big-endian/little-endian), and natively handles detection, validation, and transcoding of these encodings. For example, Merak can transcode JSON strings from a UTF-8 file to UTF-16 when parsing the file into a DOM. It also supports surrogate pairs and ",(0,i.jsx)(n.code,{children:'"\\u0000"'})," (null characters)."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["More features can be found ",(0,i.jsx)(n.a,{href:"/cppdev/docs/foundamentals/json/features",children:"here"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"JSON (JavaScript Object Notation) is a lightweight data interchange format. Merak fully complies with RFC7159/ECMA-404 and supports optional relaxed syntax. For more information about JSON:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"http://json.org/",children:"Introducing JSON"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://tools.ietf.org/html/rfc7159",children:"RFC7159: The JavaScript Object Notation (JSON) Data Interchange Format"})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://www.ecma-international.org/publications/standards/Ecma-404.htm",children:"Standard ECMA-404: The JSON Data Interchange Format"})}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"highlights-in-v11-2016-08-25",children:"Highlights in v1.1 (2016-08-25)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Added ",(0,i.jsx)(n.a,{href:"/cppdev/docs/foundamentals/json/pointer",children:"JSON Pointer"})," functionality for simpler access and modification of the DOM."]}),"\n",(0,i.jsxs)(n.li,{children:["Added ",(0,i.jsx)(n.a,{href:"/cppdev/docs/foundamentals/json/schema",children:"JSON Schema"})," functionality for validating JSON during parsing or generation."]}),"\n",(0,i.jsxs)(n.li,{children:["Added ",(0,i.jsx)(n.a,{href:"/cppdev/docs/foundamentals/json/dom",children:"relaxed JSON syntax"})," (comments, trailing commas, NaN/Infinity)."]}),"\n",(0,i.jsxs)(n.li,{children:["Support for ",(0,i.jsx)(n.a,{href:"/cppdev/docs/foundamentals/json/tutorial",children:"C++11 range-based for loops"})," to iterate over arrays and objects."]}),"\n",(0,i.jsxs)(n.li,{children:["Reduced the memory overhead of each ",(0,i.jsx)(n.code,{children:"Value"})," from 24 bytes to 16 bytes on x86-64 architectures."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"compatibility",children:"Compatibility"}),"\n",(0,i.jsx)(n.p,{children:"Merak is cross-platform. The following platform/compiler combinations have been tested:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Visual C++ 2008/2010/2013 on Windows (32/64-bit)"}),"\n",(0,i.jsx)(n.li,{children:"GNU C++ 3.8.x on Cygwin"}),"\n",(0,i.jsx)(n.li,{children:"Clang 3.4 on Mac OS X (32/64-bit) and iOS"}),"\n",(0,i.jsx)(n.li,{children:"Clang 3.4 on Android NDK"}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Users can also build and run unit tests on their own platforms."}),"\n",(0,i.jsx)(n.h2,{id:"installation",children:"Installation"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"kmpkg install merak\n"})}),"\n",(0,i.jsx)(n.h3,{id:"steps-to-build-tests-and-examples",children:"Steps to Build Tests and Examples"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"git submodule update --init"})," to fetch third-party submodules (Google Test)."]}),"\n",(0,i.jsxs)(n.li,{children:["Create a ",(0,i.jsx)(n.code,{children:"build"})," directory under the merak root directory."]}),"\n",(0,i.jsxs)(n.li,{children:["Run ",(0,i.jsx)(n.code,{children:"cmake .."})," in the ",(0,i.jsx)(n.code,{children:"build"})," directory to configure the build. Windows users can use the cmake-gui application instead."]}),"\n",(0,i.jsxs)(n.li,{children:["On Windows, build the generated solution file in the ",(0,i.jsx)(n.code,{children:"build"})," directory. On Linux, run ",(0,i.jsx)(n.code,{children:"make"})," in the ",(0,i.jsx)(n.code,{children:"build"})," directory."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["After a successful build, you will find compiled test and example executables in the ",(0,i.jsx)(n.code,{children:"bin"})," directory. Generated documentation will be located in the ",(0,i.jsx)(n.code,{children:"doc/html"})," directory under ",(0,i.jsx)(n.code,{children:"build"}),". To run the tests, execute ",(0,i.jsx)(n.code,{children:"make test"})," or ",(0,i.jsx)(n.code,{children:"ctest"})," in the ",(0,i.jsx)(n.code,{children:"build"})," directory. Use the ",(0,i.jsx)(n.code,{children:"ctest -V"})," command to get detailed test output."]}),"\n",(0,i.jsxs)(n.p,{children:["You can also install the library system-wide by running ",(0,i.jsx)(n.code,{children:"make install"})," from the ",(0,i.jsx)(n.code,{children:"build"})," directory with administrative privileges. This will install all files according to the system's preferred settings. After installing Merak, other CMake projects can use it by adding ",(0,i.jsx)(n.code,{children:"find_package(Merak)"})," to their ",(0,i.jsx)(n.code,{children:"CMakeLists.txt"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"quick-start",children:"Quick Start"}),"\n",(0,i.jsx)(n.p,{children:"This simple example parses a JSON string into a document (DOM), makes a basic modification to the DOM, and finally converts (stringifies) the DOM back to a JSON string."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-cpp",children:'// merak/json/example/simpledom/simpledom.cpp`\n#include "merak/json/document.h"\n#include "merak/json/writer.h"\n#include "merak/json/stringbuffer.h"\n#include <iostream>\n\nusing namespace merak::json;\n\nint main() {\n    // 1. Parse JSON into DOM.\n    const char* json = "{\\"project\\":\\"merak\\",\\"stars\\":10}";\n    Document d;\n    d.Parse(json);\n\n    // 2. Modify the DOM.\n    Value& s = d["stars"];\n    s.SetInt(s.GetInt() + 1);\n\n    // 3. Convert DOM back to JSON (stringify).\n    StringBuffer buffer;\n    Writer<StringBuffer> writer(buffer);\n    d.Accept(writer);\n\n    // Output {"project":"merak","stars":11}\n    std::cout << buffer.GetString() << std::endl;\n    return 0;\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:"Note that this example does not handle potential errors."}),"\n",(0,i.jsx)(n.p,{children:"The diagram below illustrates the execution process."}),"\n","\n",(0,i.jsx)("img",{src:a}),"\n",(0,i.jsxs)(n.p,{children:["Many more ",(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/tree/master/example",children:"examples"})," are available for reference:"]}),"\n",(0,i.jsx)(n.h3,{id:"dom-api",children:"DOM API"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/tutorial/tutorial.cpp",children:"tutorial"}),": Basic usage of the DOM API."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"sax-api",children:"SAX API"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/simplereader/simplereader.cpp",children:"simplereader"}),": Prints all SAX events when parsing JSON with ",(0,i.jsx)(n.code,{children:"Reader"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/condense/condense.cpp",children:"condense"}),": A command-line tool to remove all whitespace from JSON."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/pretty/pretty.cpp",children:"pretty"}),": A command-line tool to add indentation and line breaks to JSON, using ",(0,i.jsx)(n.code,{children:"PrettyWriter"}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/capitalize/capitalize.cpp",children:"capitalize"}),": A command-line tool to convert all strings in JSON to uppercase."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/messagereader/messagereader.cpp",children:"messagereader"}),": Uses the SAX API to parse a JSON message."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/serialize/serialize.cpp",children:"serialize"}),": Uses the SAX API to serialize C++ objects into JSON."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/jsonx/jsonx.cpp",children:"jsonx"}),": Implements a ",(0,i.jsx)(n.code,{children:"JsonxWriter"})," that writes SAX events into ",(0,i.jsx)(n.a,{href:"https://www-01.ibm.com/support/knowledgecenter/SS9H2Y_7.1.0/com.ibm.dp.doc/json_jsonx.html",children:"JSONx"})," (an XML format). This example is a command-line tool to convert JSON input to JSONx format."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"schema-api",children:"Schema API"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/schemavalidator/schemavalidator.cpp",children:"schemavalidator"}),": A command-line tool to validate JSON using JSON Schema."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"advanced",children:"Advanced"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/prettyauto/prettyauto.cpp",children:"prettyauto"}),": A modified version of ",(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/pretty/pretty.cpp",children:"pretty"})," that automatically handles JSON with any UTF encoding."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/parsebyparts/parsebyparts.cpp",children:"parsebyparts"}),": The ",(0,i.jsx)(n.code,{children:"AsyncDocumentParser"})," class in this example uses C++ threads to parse JSON in chunks."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/filterkey/filterkey.cpp",children:"filterkey"}),": A command-line tool to remove user-specified keys from JSON."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"https://github.com/kumose/merak/blob/master/example/filterkey/filterkey.cpp",children:"filterkeydom"}),": The same tool as above, but demonstrates how to use a generator to populate a ",(0,i.jsx)(n.code,{children:"Document"}),"."]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>l});var t=s(6540);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);