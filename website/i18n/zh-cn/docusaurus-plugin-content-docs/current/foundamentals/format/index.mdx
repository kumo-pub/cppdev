# 格式化与输出（字符串格式化和输出）

字符串格式化和输出是项目中的高频基础能力，主要用于日志打印、控制台信息输出、数据可视化和业务字符串拼接。该模块侧重于高性能和可扩展的格式化解决方案，相比标准库的 `std::stringstream/std::printf` 有显著性能优势，同时支持颜色/样式输出和日志场景的定制封装。

## 核心能力与选型建议
| 能力 / 库                | 核心描述                                                                 | 选型建议                                                                 |
|---------------------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------|
| `turbo/strings/str_format` | 类 C 的格式化接口，语法接近 `printf`，与项目核心技术栈一致，无额外依赖 | **首选（通用格式化场景）**：适用于常规字符串格式化需求；接口简单，性能优于 std/abseil |
| `turbo/strings/string_builder` | 基于流的字符串构建器，可替代 `std::stringstream`，性能提升约 50%，无冗余内存分配 | **首选（高频拼接/大字符串构建）**：适用于日志拼接、批量数据格式化等 |
| `abseil/strings/format`  | 基础格式化功能，仅因 protobuf 依赖间接引入项目                         | 不推荐主动使用：仅兼容遗留代码，新场景统一使用 turbo 解决方案 |
| `fmtlib/fmt`             | 功能全面的第三方格式化库，支持丰富语法扩展                              | **备选**：仅在 turbo 接口无法满足复杂格式化需求时使用（如自定义类型格式化） |
| `ftxui`                  | 独立终端 UI 库，支持终端文本颜色、布局、交互界面，可结合 fmt 实现格式化与样式输出 | **场景使用**：适用于控制台可视化和交互输出场景，配合 fmt 实现格式逻辑 |
| `xlog`                   | 封装 fmt 的终端日志输出，适配项目日志系统                               | **专属场景**：日志输出必须使用 xlog，不可直接调用 fmt/turbo 格式化接口 |

## 关键补充说明
1. 性能优先级：`turbo::string_builder` > `turbo::str_format` > `fmtlib/fmt` > `abseil::format` > `std` 标准库；
2. 样式化输出：对于终端颜色/布局需求，优先使用 ftxui 配合 fmt 实现“内容格式化 + 样式渲染”，避免手动实现 ANSI 转义字符造成兼容性问题；
3. 日志场景强制规范：所有日志输出必须使用 xlog 封装接口，禁止直接调用格式化库输出，以保证日志格式统一。

## 集成指南
- 集成 turbo 库：[integration/turbo](../../integration/turbo.md)
- 集成 fmtlib 库：[integration/fmt](../../integration/fmt.md)
- 集成 ftxui 库：[integration/ftxui](../../integration/ftxui.md)
- 集成 xlog 库：[integration/xlog](../../integration/xlog.md)

